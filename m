Return-Path: <linux-riscv-bounces+lists+linux-riscv=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-riscv@lfdr.de
Delivered-To: lists+linux-riscv@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 20FBE4F0ED
	for <lists+linux-riscv@lfdr.de>; Sat, 22 Jun 2019 01:00:15 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:Message-Id:Date:Subject:To
	:From:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
	Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:
	List-Owner; bh=ZICe7DmuCI0rB4hNbXxxZ24oFR0O5o3pjXBzDMgVFiQ=; b=eKSO1d17reXwuK
	GTXXbjHNAKGT4vzm9m/cD+3fa101+eWjS3drGVn77EQBmUyVRF6S1FnT6lP9OuRR+0HOUNWNVr69R
	INET20dDhBA5F1Ojna3cmfgSTs+R3pGwzFpqL4vqJ4IZOhTrW79qXqCSSw0GLGRpTu1wYNeZ641wV
	7a1sO2k3JiCE6e62okCx+cl2N7YSsYzttnkcSNY1E1lLg50yi+zWW7elmOmCH/I+l40yQygeCGHGs
	/yq9dyCCVJodzVaZE6sNiBAUZ94XZfP67hGdZo+ujsQpi+PJrFF2EDZbjIlJnZ3UbLTDcNkWBvd67
	WsnbPY7t8mZ0Mj8AbrYQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1heSVn-0007g7-Ef; Fri, 21 Jun 2019 23:00:03 +0000
Received: from mail-pg1-x542.google.com ([2607:f8b0:4864:20::542])
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1heSVh-0007Z3-BX
 for linux-riscv@lists.infradead.org; Fri, 21 Jun 2019 23:00:00 +0000
Received: by mail-pg1-x542.google.com with SMTP id m4so3438489pgk.0
 for <linux-riscv@lists.infradead.org>; Fri, 21 Jun 2019 15:59:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=cs.washington.edu; s=goo201206;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=M31YXjUbqIrBUCONowiBoSS838lXx+womVO0lJGQhMU=;
 b=I7HVQZ32zGS0yCBtvHOQb5tZvXf0764JkOHJozDzu3N6IBHDJfNfL7bkcmHALab/Ql
 oXMEPoa4je6qh1E+nhrfUwk8ZAaaJ7CroJ+BC2NHqVtfscQxMVCKchlqlMV8Z9pL1YPi
 qcSF92XrXtm30V+o3Ajzk5zZVD6QEHHDx9XtE=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=M31YXjUbqIrBUCONowiBoSS838lXx+womVO0lJGQhMU=;
 b=RM2jO+jLrcId5RpEheYkAZ+nWVxaPSUGQGMjanX2LOKkjm8ICOrixwOlHTf27kZvfX
 Pm20AoKmtIhCJAS4oincN2pkbBIGxUPhGSoYh34n4f2Q1mdWX6W207PVErZ1sXFEOM6N
 jD2jZgsh7AY9vRc217ZLCO3BNcBDl22tY7cqi6wuGex4u2zXiyVjbjVaRiaII0z41nB7
 60j2Vxt9Qily50MnoQfF4qsNCHVEPF9LUxXUWjaON/F8WKbFv+6r0z7qUB2KuSOZ+s+J
 0iRBp4XIdS6usAnzsMJGfJ7xbnHI5yZ2KBODV6qvPY3GZE73jiEP7nMTgVJ47WnBAggh
 TizA==
X-Gm-Message-State: APjAAAXeSh8lAbLJ9UFetyfuEtCVAx/5nawMxi+IeSf4a3gMLTHZjrsc
 KZp1YdeWv+ZebpPHQaVMAlUbQw==
X-Google-Smtp-Source: APXvYqzK82vIsLhmGB6l8lZUd0BQuEzi5IYn5hCXxy6GQEqNR5hKm0+adhyc62hHaIxLjF9LGCFKnA==
X-Received: by 2002:a63:9502:: with SMTP id p2mr10726824pgd.12.1561157992207; 
 Fri, 21 Jun 2019 15:59:52 -0700 (PDT)
Received: from ryzen.cs.washington.edu ([2607:4000:200:15:7cc3:b2be:5b15:4236])
 by smtp.gmail.com with ESMTPSA id 27sm3896387pgl.82.2019.06.21.15.59.51
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Fri, 21 Jun 2019 15:59:51 -0700 (PDT)
From: Luke Nelson <lukenels@cs.washington.edu>
To: 
Subject: [RFC PATCH bpf-next] RV32G eBPF JIT
Date: Fri, 21 Jun 2019 15:59:30 -0700
Message-Id: <20190621225938.27030-1-lukenels@cs.washington.edu>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190621_155957_443916_7EE244DA 
X-CRM114-Status: GOOD (  16.56  )
X-Spam-Score: -0.1 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.1 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [2607:f8b0:4864:20:0:0:0:542 listed in]
 [list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 0.0 SPF_NONE               SPF: sender does not publish an SPF Record
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
X-BeenThere: linux-riscv@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-riscv.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-riscv>,
 <mailto:linux-riscv-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-riscv/>
List-Post: <mailto:linux-riscv@lists.infradead.org>
List-Help: <mailto:linux-riscv-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-riscv>,
 <mailto:linux-riscv-request@lists.infradead.org?subject=subscribe>
Cc: Song Liu <songliubraving@fb.com>, Albert Ou <aou@eecs.berkeley.edu>,
 bpf@vger.kernel.org, Daniel Borkmann <daniel@iogearbox.net>,
 Luke Nelson <luke.r.nels@gmail.com>,
 =?UTF-8?q?Bj=C3=B6rn=20T=C3=B6pel?= <bjorn.topel@gmail.com>,
 Palmer Dabbelt <palmer@sifive.com>, Alexei Starovoitov <ast@kernel.org>,
 linux-kernel@vger.kernel.org, netdev@vger.kernel.org,
 Yonghong Song <yhs@fb.com>, linux-riscv@lists.infradead.org,
 Martin KaFai Lau <kafai@fb.com>, Xi Wang <xi.wang@gmail.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-riscv" <linux-riscv-bounces@lists.infradead.org>
Errors-To: linux-riscv-bounces+lists+linux-riscv=lfdr.de@lists.infradead.org

RnJvbTogTHVrZSBOZWxzb24gPGx1a2Uuci5uZWxzQGdtYWlsLmNvbT4KClRoaXMgaXMgYW4gZUJQ
RiBKSVQgZm9yIFJWMzJHLCBhZGFwdGVkIGZyb20gdGhlIEpJVCBmb3IgUlY2NEcuCkFueSBmZWVk
YmFjayB3b3VsZCBiZSBncmVhdGx5IGFwcHJlY2lhdGVkLgoKSXQgcGFzc2VzIDM1OSBvdXQgb2Yg
Mzc4IHRlc3RzIGluIHRlc3RfYnBmLmtvLiBUaGUgZmFpbGluZyB0ZXN0cyBhcmUKZmVhdHVyZXMg
dGhhdCBhcmUgbm90IHN1cHBvcnRlZCByaWdodCBub3c6CiAgLSBBTFU2NCBESVYvTU9EOgogICAg
ICBUaGVzZSByZXF1aXJlIGxvb3BzIHRvIGVtdWxhdGUgb24gMzItYml0IGhhcmR3YXJlLAogICAg
ICBhbmQgYXJlIG5vdCBzdXBwb3J0ZWQgb24gb3RoZXIgMzItYml0IEpJVHMgbGlrZQogICAgICBB
Uk0zMi4KICAtIEJQRl9YQUREIHwgQlBGX0RXOgogICAgICBSVjMyRyBkb2VzIG5vdCBoYXZlIGF0
b21pYyBpbnN0cnVjdGlvbnMgZm9yIG9wZXJhdGluZwogICAgICBvbiBkb3VibGUgd29yZHMuIFRo
aXMgaXMgc2ltaWxhciB0byBBUk0zMi4KICAtIFRhaWwgY2FsbHM6CiAgICAgIEknbSB3b3JraW5n
IG9uIGFkZGluZyBzdXBwb3J0IGZvciB0aGVzZSBub3csIGJ1dCBjb3VsZG4ndAogICAgICBmaW5k
IGFueSB0ZXN0IGNhc2VzIHRoYXQgdXNlIHRoZW0uIFdoYXQncyB0aGUgYmVzdCB3YXkKICAgICAg
b2YgdGVzdGluZyB0YWlsIGNhbGwgY29kZT8KICAtIEZhciBicmFuY2hlcwogICAgICBUaGVzZSBh
cmUgbm90IHN1cHBvcnRlZCBpbiBSVjY0RyBlaXRoZXIuCgpUaGVyZSBhcmUgdHdvIG1haW4gY2hh
bmdlcyByZXF1aXJlZCBmb3IgdGhpcyB0byB3b3JrIGNvbXBhcmVkIHRvIHRoZQpSVjY0IEpJVC4K
CkZpcnN0LCBlQlBGIHJlZ2lzdGVycyBhcmUgNjQtYml0LCB3aGlsZSBSVjMyRyByZWdpc3RlcnMg
YXJlIDMyLWJpdC4KSSB0YWtlIGFuIGFwcHJvYWNoIHNpbWlsYXIgdG8gQVJNMzI6IG1vc3QgQlBG
IHJlZ2lzdGVycyBtYXAgZGlyZWN0bHkgdG8KMiBSSVNDLVYgcmVnaXN0ZXJzLCB3aGlsZSBzb21l
IHJlc2lkZSBpbiBzdGFjayBzY3JhdGNoIHNwYWNlIGFuZCBtdXN0CmJlIHNhdmVkIC8gcmVzdG9y
ZWQgd2hlbiB1c2VkLgoKU2Vjb25kLCBtYW55IDY0LWJpdCBBTFUgb3BlcmF0aW9ucyBkbyBub3Qg
dHJpdmlhbGx5IG1hcCB0byAzMi1iaXQKb3BlcmF0aW9ucy4gT3BlcmF0aW9ucyB0aGF0IG1vdmUg
Yml0cyBiZXR3ZWVuIGhpZ2ggYW5kIGxvdyB3b3Jkcywgc3VjaAphcyBBREQsIExTSCwgTVVMLCBh
bmQgb3RoZXJzIG11c3QgZW11bGF0ZSB0aGUgNjQtYml0IGJlaGF2aW9yIGluIHRlcm1zCm9mIDMy
LWJpdCBpbnN0cnVjdGlvbnMuCgpTaWduZWQtb2ZmLWJ5OiBMdWtlIE5lbHNvbiA8bHVrZS5yLm5l
bHNAZ21haWwuY29tPgpDYzogWGkgV2FuZyA8eGkud2FuZ0BnbWFpbC5jb20+Ci0tLQogYXJjaC9y
aXNjdi9LY29uZmlnICAgICAgICAgICAgICB8ICAgIDIgKy0KIGFyY2gvcmlzY3YvbmV0L01ha2Vm
aWxlICAgICAgICAgfCAgICA3ICstCiBhcmNoL3Jpc2N2L25ldC9icGZfaml0X2NvbXAzMi5jIHwg
MTQ2MCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDE0
NjcgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBhcmNo
L3Jpc2N2L25ldC9icGZfaml0X2NvbXAzMi5jCgpkaWZmIC0tZ2l0IGEvYXJjaC9yaXNjdi9LY29u
ZmlnIGIvYXJjaC9yaXNjdi9LY29uZmlnCmluZGV4IDBjNGIxMjIwNTYzMi4uMTUzZmY5ZWU2ZTZj
IDEwMDY0NAotLS0gYS9hcmNoL3Jpc2N2L0tjb25maWcKKysrIGIvYXJjaC9yaXNjdi9LY29uZmln
CkBAIC00OSw3ICs0OSw3IEBAIGNvbmZpZyBSSVNDVgogCXNlbGVjdCBHRU5FUklDX0lSUV9NVUxU
SV9IQU5ETEVSCiAJc2VsZWN0IEFSQ0hfSEFTX1BURV9TUEVDSUFMCiAJc2VsZWN0IEFSQ0hfSEFT
X01NSU9XQgotCXNlbGVjdCBIQVZFX0VCUEZfSklUIGlmIDY0QklUCisJc2VsZWN0IEhBVkVfRUJQ
Rl9KSVQKIAogY29uZmlnIE1NVQogCWRlZl9ib29sIHkKZGlmZiAtLWdpdCBhL2FyY2gvcmlzY3Yv
bmV0L01ha2VmaWxlIGIvYXJjaC9yaXNjdi9uZXQvTWFrZWZpbGUKaW5kZXggZWM1YjE0NzYzMzE2
Li41NTExZmIxZGQ0MGUgMTAwNjQ0Ci0tLSBhL2FyY2gvcmlzY3YvbmV0L01ha2VmaWxlCisrKyBi
L2FyY2gvcmlzY3YvbmV0L01ha2VmaWxlCkBAIC0xLDIgKzEsNyBAQAogIyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Ci1vYmotJChDT05GSUdfQlBGX0pJVCkgKz0gYnBmX2pp
dF9jb21wLm8KKworaWZlcSAoJChDT05GSUdfQVJDSF9SVjY0SSkseSkKKwlvYmotJChDT05GSUdf
QlBGX0pJVCkgKz0gYnBmX2ppdF9jb21wLm8KK2Vsc2UKKwlvYmotJChDT05GSUdfQlBGX0pJVCkg
Kz0gYnBmX2ppdF9jb21wMzIubworZW5kaWYKZGlmZiAtLWdpdCBhL2FyY2gvcmlzY3YvbmV0L2Jw
Zl9qaXRfY29tcDMyLmMgYi9hcmNoL3Jpc2N2L25ldC9icGZfaml0X2NvbXAzMi5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODc5MGZkOTMxYWVkCi0tLSAvZGV2L251
bGwKKysrIGIvYXJjaC9yaXNjdi9uZXQvYnBmX2ppdF9jb21wMzIuYwpAQCAtMCwwICsxLDE0NjAg
QEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKiBCUEYgSklUIGNvbXBp
bGVyIGZvciBSVjMyRworICoKKyAqIENvcHlyaWdodChjKSAyMDE5IEx1a2UgTmVsc29uIDxsdWtl
LnIubmVsc0BnbWFpbC5jb20+CisgKiBUaGlzIGNvZGUgaXMgYmFzZWQgb24gdGhlIGNvZGUgYW5k
IGlkZWFzIGZyb20KKyAqIEJqw7ZybiBUw7ZwZWwgPGJqb3JuLnRvcGVsQGdtYWlsLmNvbT4sCisg
KiB3aG8gd3JvdGUgdGhlIHJ2NjRnIEJQRiBKSVQsIGFuZAorICogU2h1YmhhbSBCYW5zYWwgPGls
bHVzaW9uaXN0Lm5lb0BnbWFpbC5jb20+IGFuZAorICogTWlyY2VhIEdoZXJ6YW4gPG1naGVyemFu
QGdtYWlsLmNvbT4sCisgKiB3aG8gd3JvdGUgdGhlIDMyLWJpdCBBUk0gQlBGIEpJVC4KKyAqLwor
CisjaW5jbHVkZSA8bGludXgvYnBmLmg+CisjaW5jbHVkZSA8bGludXgvZmlsdGVyLmg+CisjaW5j
bHVkZSA8YXNtL2NhY2hlZmx1c2guaD4KKworZW51bSB7CisJUlZfUkVHX1pFUk8gPQkwLAkvKiBU
aGUgY29uc3RhbnQgdmFsdWUgMCAqLworCVJWX1JFR19SQSA9CTEsCS8qIFJldHVybiBhZGRyZXNz
ICovCisJUlZfUkVHX1NQID0JMiwJLyogU3RhY2sgcG9pbnRlciAqLworCVJWX1JFR19HUCA9CTMs
CS8qIEdsb2JhbCBwb2ludGVyICovCisJUlZfUkVHX1RQID0JNCwJLyogVGhyZWFkIHBvaW50ZXIg
Ki8KKwlSVl9SRUdfVDAgPQk1LAkvKiBUZW1wb3JhcmllcyAqLworCVJWX1JFR19UMSA9CTYsCisJ
UlZfUkVHX1QyID0JNywKKwlSVl9SRUdfRlAgPQk4LAorCVJWX1JFR19TMSA9CTksCS8qIFNhdmVk
IHJlZ2lzdGVycyAqLworCVJWX1JFR19BMCA9CTEwLAkvKiBGdW5jdGlvbiBhcmd1bWVudC9yZXR1
cm4gdmFsdWVzICovCisJUlZfUkVHX0ExID0JMTEsCS8qIEZ1bmN0aW9uIGFyZ3VtZW50cyAqLwor
CVJWX1JFR19BMiA9CTEyLAorCVJWX1JFR19BMyA9CTEzLAorCVJWX1JFR19BNCA9CTE0LAorCVJW
X1JFR19BNSA9CTE1LAorCVJWX1JFR19BNiA9CTE2LAorCVJWX1JFR19BNyA9CTE3LAorCVJWX1JF
R19TMiA9CTE4LAkvKiBTYXZlZCByZWdpc3RlcnMgKi8KKwlSVl9SRUdfUzMgPQkxOSwKKwlSVl9S
RUdfUzQgPQkyMCwKKwlSVl9SRUdfUzUgPQkyMSwKKwlSVl9SRUdfUzYgPQkyMiwKKwlSVl9SRUdf
UzcgPQkyMywKKwlSVl9SRUdfUzggPQkyNCwKKwlSVl9SRUdfUzkgPQkyNSwKKwlSVl9SRUdfUzEw
ID0JMjYsCisJUlZfUkVHX1MxMSA9CTI3LAorCVJWX1JFR19UMyA9CTI4LAkvKiBUZW1wb3Jhcmll
cyAqLworCVJWX1JFR19UNCA9CTI5LAorCVJWX1JFR19UNSA9CTMwLAorCVJWX1JFR19UNiA9CTMx
LAorfTsKKworZW51bSB7CisJLyogU3RhY2sgbGF5b3V0IC0gdGhlc2UgYXJlIG9mZnNldHMgZnJv
bSAodG9wIG9mIHN0YWNrIC0gNCkgKi8KKwlCUEZfUjZfSEksCisJQlBGX1I2X0xPLAorCUJQRl9S
N19ISSwKKwlCUEZfUjdfTE8sCisJQlBGX1I4X0hJLAorCUJQRl9SOF9MTywKKwlCUEZfUjlfSEks
CisJQlBGX1I5X0xPLAorCUJQRl9UQ19ISSwKKwlCUEZfVENfTE8sCisJQlBGX0FYX0hJLAorCUJQ
Rl9BWF9MTywKKwkvKiBTdGFjayBzcGFjZSBmb3IgQlBGX1JFR182LCBCUEZfUkVHXzcsIEJQRl9S
RUdfOCwgQlBGX1JFR185LAorCSAqIEJQRl9SRUdfQVggYW5kIHRhaWwgY2FsbCBjb3VudHMuCisJ
ICovCisJQlBGX0pJVF9TQ1JBVENIX1JFR1MsCit9OworCisjZGVmaW5lIFNUQUNLX09GRlNFVChr
KSAoLTQgLSAoKGspICogNCkpCisKKyNkZWZpbmUgVE1QX1JFR18xCShNQVhfQlBGX0pJVF9SRUcg
KyAwKQkvKiBURU1QIFJlZ2lzdGVyIDEgKi8KKyNkZWZpbmUgVE1QX1JFR18yCShNQVhfQlBGX0pJ
VF9SRUcgKyAxKQkvKiBURU1QIFJlZ2lzdGVyIDIgKi8KKyNkZWZpbmUgVENBTExfQ05UCShNQVhf
QlBGX0pJVF9SRUcgKyAyKQkvKiBUYWlsIENhbGwgQ291bnQgKi8KKworc3RhdGljIGNvbnN0IHM4
IGJwZjJydjMyW11bMl0gPSB7CisJLyogUmV0dXJuIHZhbHVlIGZyb20gaW4ta2VybmVsIGZ1bmN0
aW9uLCBhbmQgZXhpdCB2YWx1ZSBmcm9tIGVCUEYgKi8KKwlbQlBGX1JFR18wXSA9IHtSVl9SRUdf
UzIsIFJWX1JFR19TMX0sCisJLyogQXJndW1lbnRzIGZyb20gZUJQRiBwcm9ncmFtIHRvIGluLWtl
cm5lbCBmdW5jdGlvbiAqLworCVtCUEZfUkVHXzFdID0ge1JWX1JFR19BMSwgUlZfUkVHX0EwfSwK
KwlbQlBGX1JFR18yXSA9IHtSVl9SRUdfQTMsIFJWX1JFR19BMn0sCisJW0JQRl9SRUdfM10gPSB7
UlZfUkVHX0E1LCBSVl9SRUdfQTR9LAorCVtCUEZfUkVHXzRdID0ge1JWX1JFR19BNywgUlZfUkVH
X0E2fSwKKwlbQlBGX1JFR181XSA9IHtSVl9SRUdfUzQsIFJWX1JFR19TM30sCisJLyogQ2FsbGVl
IHNhdmVkIHJlZ2lzdGVycyB0aGF0IGluLWtlcm5lbCBmdW5jdGlvbiB3aWxsIHByZXNlcnZlICov
CisJLyogU3RvcmVkIG9uIHN0YWNrIHNjcmF0Y2ggc3BhY2UgKi8KKwlbQlBGX1JFR182XSA9IHtT
VEFDS19PRkZTRVQoQlBGX1I2X0hJKSwgU1RBQ0tfT0ZGU0VUKEJQRl9SNl9MTyl9LAorCVtCUEZf
UkVHXzddID0ge1NUQUNLX09GRlNFVChCUEZfUjdfSEkpLCBTVEFDS19PRkZTRVQoQlBGX1I3X0xP
KX0sCisJW0JQRl9SRUdfOF0gPSB7U1RBQ0tfT0ZGU0VUKEJQRl9SOF9ISSksIFNUQUNLX09GRlNF
VChCUEZfUjhfTE8pfSwKKwlbQlBGX1JFR185XSA9IHtTVEFDS19PRkZTRVQoQlBGX1I5X0hJKSwg
U1RBQ0tfT0ZGU0VUKEJQRl9SOV9MTyl9LAorCS8qIFJlYWQgb25seSBGcmFtZSBQb2ludGVyIHRv
IGFjY2VzcyBTdGFjayAqLworCVtCUEZfUkVHX0ZQXSA9IHtSVl9SRUdfUzYsIFJWX1JFR19TNX0s
CisJLyogVGVtcG9yYXJ5IFJlZ2lzdGVyIGZvciBpbnRlcm5hbCBCUEYgSklULCBjYW4gYmUgdXNl
ZAorCSAqIGZvciBjb25zdGFudCBibGluZGluZ3MgYW5kIG90aGVycy4gU2F2ZSBUMCBhbmQgVDEK
KwkgKiBmb3IgdXNlIGludGVybmFsIHRvIG9uZSBpbnN0cnVjdGlvbi4KKwkgKi8KKwlbVE1QX1JF
R18xXSA9IHtSVl9SRUdfVDMsIFJWX1JFR19UMn0sCisJW1RNUF9SRUdfMl0gPSB7UlZfUkVHX1Q1
LCBSVl9SRUdfVDR9LAorCS8qIFRhaWwgY2FsbCBjb3VudC4gU3RvcmVkIG9uIHN0YWNrIHNjcmF0
Y2ggc3BhY2UuICovCisJW1RDQUxMX0NOVF0gPSB7U1RBQ0tfT0ZGU0VUKEJQRl9UQ19ISSksIFNU
QUNLX09GRlNFVChCUEZfVENfTE8pfSwKKwkvKiBUZW1wb3JhcnkgcmVnaXN0ZXIgZm9yIGJsaW5k
aW5nIGNvbnN0YW50cy4KKwkgKiBTdG9yZWQgb24gc3RhY2sgc2NyYXRjaCBzcGFjZS4KKwkgKi8K
KwlbQlBGX1JFR19BWF0gPSB7U1RBQ0tfT0ZGU0VUKEJQRl9BWF9ISSksIFNUQUNLX09GRlNFVChC
UEZfQVhfTE8pfSwKK307CisKK3N0cnVjdCBydl9qaXRfY29udGV4dCB7CisJc3RydWN0IGJwZl9w
cm9nICpwcm9nOworCXUzMiAqaW5zbnM7IC8qIFJWIGluc25zICovCisJaW50IG5pbnNuczsKKwlp
bnQgZXBpbG9ndWVfb2Zmc2V0OworCWludCAqb2Zmc2V0OyAvKiBCUEYgdG8gUlYgKi8KKwl1bnNp
Z25lZCBsb25nIGZsYWdzOworCWludCBzdGFja19zaXplOworfTsKKworc3RydWN0IHJ2X2ppdF9k
YXRhIHsKKwlzdHJ1Y3QgYnBmX2JpbmFyeV9oZWFkZXIgKmhlYWRlcjsKKwl1OCAqaW1hZ2U7CisJ
c3RydWN0IHJ2X2ppdF9jb250ZXh0IGN0eDsKK307CisKK3N0YXRpYyB2b2lkIGVtaXQoY29uc3Qg
dTMyIGluc24sIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4KQoreworCWlmIChjdHgtPmluc25z
KQorCQljdHgtPmluc25zW2N0eC0+bmluc25zXSA9IGluc247CisKKwljdHgtPm5pbnNucysrOwor
fQorCitzdGF0aWMgdTMyIHJ2X3JfaW5zbih1OCBmdW5jdDcsIHU4IHJzMiwgdTggcnMxLCB1OCBm
dW5jdDMsIHU4IHJkLCB1OCBvcGNvZGUpCit7CisJcmV0dXJuIChmdW5jdDcgPDwgMjUpIHwgKHJz
MiA8PCAyMCkgfCAocnMxIDw8IDE1KSB8IChmdW5jdDMgPDwgMTIpIHwKKwkJKHJkIDw8IDcpIHwg
b3Bjb2RlOworfQorCitzdGF0aWMgdTMyIHJ2X2lfaW5zbih1MTYgaW1tMTFfMCwgdTggcnMxLCB1
OCBmdW5jdDMsIHU4IHJkLCB1OCBvcGNvZGUpCit7CisJcmV0dXJuIChpbW0xMV8wIDw8IDIwKSB8
IChyczEgPDwgMTUpIHwgKGZ1bmN0MyA8PCAxMikgfCAocmQgPDwgNykgfAorCQlvcGNvZGU7Cit9
CisKK3N0YXRpYyB1MzIgcnZfc19pbnNuKHUxNiBpbW0xMV8wLCB1OCByczIsIHU4IHJzMSwgdTgg
ZnVuY3QzLCB1OCBvcGNvZGUpCit7CisJdTggaW1tMTFfNSA9IGltbTExXzAgPj4gNSwgaW1tNF8w
ID0gaW1tMTFfMCAmIDB4MWY7CisKKwlyZXR1cm4gKGltbTExXzUgPDwgMjUpIHwgKHJzMiA8PCAy
MCkgfCAocnMxIDw8IDE1KSB8IChmdW5jdDMgPDwgMTIpIHwKKwkJKGltbTRfMCA8PCA3KSB8IG9w
Y29kZTsKK30KKworc3RhdGljIHUzMiBydl9zYl9pbnNuKHUxNiBpbW0xMl8xLCB1OCByczIsIHU4
IHJzMSwgdTggZnVuY3QzLCB1OCBvcGNvZGUpCit7CisJdTggaW1tMTIgPSAoKGltbTEyXzEgJiAw
eDgwMCkgPj4gNSkgfCAoKGltbTEyXzEgJiAweDNmMCkgPj4gNCk7CisJdTggaW1tNF8xID0gKChp
bW0xMl8xICYgMHhmKSA8PCAxKSB8ICgoaW1tMTJfMSAmIDB4NDAwKSA+PiAxMCk7CisKKwlyZXR1
cm4gKGltbTEyIDw8IDI1KSB8IChyczIgPDwgMjApIHwgKHJzMSA8PCAxNSkgfCAoZnVuY3QzIDw8
IDEyKSB8CisJCShpbW00XzEgPDwgNykgfCBvcGNvZGU7Cit9CisKK3N0YXRpYyB1MzIgcnZfdV9p
bnNuKHUzMiBpbW0zMV8xMiwgdTggcmQsIHU4IG9wY29kZSkKK3sKKwlyZXR1cm4gKGltbTMxXzEy
IDw8IDEyKSB8IChyZCA8PCA3KSB8IG9wY29kZTsKK30KKworc3RhdGljIHUzMiBydl91al9pbnNu
KHUzMiBpbW0yMF8xLCB1OCByZCwgdTggb3Bjb2RlKQoreworCXUzMiBpbW07CisKKwlpbW0gPSAo
aW1tMjBfMSAmIDB4ODAwMDApIHwgICgoaW1tMjBfMSAmIDB4M2ZmKSA8PCA5KSB8CisJCSAgKChp
bW0yMF8xICYgMHg0MDApID4+IDIpIHwgKChpbW0yMF8xICYgMHg3ZjgwMCkgPj4gMTEpOworCisJ
cmV0dXJuIChpbW0gPDwgMTIpIHwgKHJkIDw8IDcpIHwgb3Bjb2RlOworfQorCitzdGF0aWMgdTMy
IHJ2X2Ftb19pbnNuKHU4IGZ1bmN0NSwgdTggYXEsIHU4IHJsLCB1OCByczIsIHU4IHJzMSwKKwkJ
CSAgIHU4IGZ1bmN0MywgdTggcmQsIHU4IG9wY29kZSkKK3sKKwl1OCBmdW5jdDcgPSAoZnVuY3Q1
IDw8IDIpIHwgKGFxIDw8IDEpIHwgcmw7CisKKwlyZXR1cm4gcnZfcl9pbnNuKGZ1bmN0NywgcnMy
LCByczEsIGZ1bmN0MywgcmQsIG9wY29kZSk7Cit9CisKK3N0YXRpYyB1MzIgcnZfYWRkaSh1OCBy
ZCwgdTggcnMxLCB1MTYgaW1tMTFfMCkKK3sKKwlyZXR1cm4gcnZfaV9pbnNuKGltbTExXzAsIHJz
MSwgMCwgcmQsIDB4MTMpOworfQorCitzdGF0aWMgdTMyIHJ2X2FkZCh1OCByZCwgdTggcnMxLCB1
OCByczIpCit7CisJcmV0dXJuIHJ2X3JfaW5zbigwLCByczIsIHJzMSwgMCwgcmQsIDB4MzMpOwor
fQorCitzdGF0aWMgdTMyIHJ2X3N1Yih1OCByZCwgdTggcnMxLCB1OCByczIpCit7CisJcmV0dXJu
IHJ2X3JfaW5zbigweDIwLCByczIsIHJzMSwgMCwgcmQsIDB4MzMpOworfQorCitzdGF0aWMgdTMy
IHJ2X2FuZCh1OCByZCwgdTggcnMxLCB1OCByczIpCit7CisJcmV0dXJuIHJ2X3JfaW5zbigwLCBy
czIsIHJzMSwgNywgcmQsIDB4MzMpOworfQorCitzdGF0aWMgdTMyIHJ2X29yKHU4IHJkLCB1OCBy
czEsIHU4IHJzMikKK3sKKwlyZXR1cm4gcnZfcl9pbnNuKDAsIHJzMiwgcnMxLCA2LCByZCwgMHgz
Myk7Cit9CisKK3N0YXRpYyB1MzIgcnZfeG9yKHU4IHJkLCB1OCByczEsIHU4IHJzMikKK3sKKwly
ZXR1cm4gcnZfcl9pbnNuKDAsIHJzMiwgcnMxLCA0LCByZCwgMHgzMyk7Cit9CisKK3N0YXRpYyB1
MzIgcnZfbXVsKHU4IHJkLCB1OCByczEsIHU4IHJzMikKK3sKKwlyZXR1cm4gcnZfcl9pbnNuKDEs
IHJzMiwgcnMxLCAwLCByZCwgMHgzMyk7Cit9CisKK3N0YXRpYyB1MzIgcnZfbXVsaHUodTggcmQs
IHU4IHJzMSwgdTggcnMyKQoreworCXJldHVybiBydl9yX2luc24oMSwgcnMyLCByczEsIDMsIHJk
LCAweDMzKTsKK30KKworc3RhdGljIHUzMiBydl9kaXZ1KHU4IHJkLCB1OCByczEsIHU4IHJzMikK
K3sKKwlyZXR1cm4gcnZfcl9pbnNuKDEsIHJzMiwgcnMxLCA1LCByZCwgMHgzMyk7Cit9CisKK3N0
YXRpYyB1MzIgcnZfcmVtdSh1OCByZCwgdTggcnMxLCB1OCByczIpCit7CisJcmV0dXJuIHJ2X3Jf
aW5zbigxLCByczIsIHJzMSwgNywgcmQsIDB4MzMpOworfQorCitzdGF0aWMgdTMyIHJ2X3NsbCh1
OCByZCwgdTggcnMxLCB1OCByczIpCit7CisJcmV0dXJuIHJ2X3JfaW5zbigwLCByczIsIHJzMSwg
MSwgcmQsIDB4MzMpOworfQorCitzdGF0aWMgdTMyIHJ2X3NybCh1OCByZCwgdTggcnMxLCB1OCBy
czIpCit7CisJcmV0dXJuIHJ2X3JfaW5zbigwLCByczIsIHJzMSwgNSwgcmQsIDB4MzMpOworfQor
CitzdGF0aWMgdTMyIHJ2X3NyYSh1OCByZCwgdTggcnMxLCB1OCByczIpCit7CisJcmV0dXJuIHJ2
X3JfaW5zbigweDIwLCByczIsIHJzMSwgNSwgcmQsIDB4MzMpOworfQorCitzdGF0aWMgdTMyIHJ2
X3NsdHUodTggcmQsIHU4IHJzMSwgdTggcnMyKQoreworCXJldHVybiBydl9yX2luc24oMCwgcnMy
LCByczEsIDMsIHJkLCAweDMzKTsKK30KKworc3RhdGljIHUzMiBydl9sdWkodTggcmQsIHUzMiBp
bW0zMV8xMikKK3sKKwlyZXR1cm4gcnZfdV9pbnNuKGltbTMxXzEyLCByZCwgMHgzNyk7Cit9CisK
K3N0YXRpYyB1MzIgcnZfc2xsaSh1OCByZCwgdTggcnMxLCB1MTYgaW1tMTFfMCkKK3sKKwlyZXR1
cm4gcnZfaV9pbnNuKGltbTExXzAsIHJzMSwgMSwgcmQsIDB4MTMpOworfQorCitzdGF0aWMgdTMy
IHJ2X3NybGkodTggcmQsIHU4IHJzMSwgdTE2IGltbTExXzApCit7CisJcmV0dXJuIHJ2X2lfaW5z
bihpbW0xMV8wLCByczEsIDUsIHJkLCAweDEzKTsKK30KKworc3RhdGljIHUzMiBydl9zcmFpKHU4
IHJkLCB1OCByczEsIHUxNiBpbW0xMV8wKQoreworCXJldHVybiBydl9pX2luc24oMHg0MDAgfCBp
bW0xMV8wLCByczEsIDUsIHJkLCAweDEzKTsKK30KKworc3RhdGljIHUzMiBydl9hbmRpKHU4IHJk
LCB1OCByczEsIHUxNiBpbW0xMV8wKQoreworCXJldHVybiBydl9pX2luc24oaW1tMTFfMCwgcnMx
LCA3LCByZCwgMHgxMyk7Cit9CisKK3N0YXRpYyB1MzIgcnZfamFsKHU4IHJkLCB1MzIgaW1tMjBf
MSkKK3sKKwlyZXR1cm4gcnZfdWpfaW5zbihpbW0yMF8xLCByZCwgMHg2Zik7Cit9CisKK3N0YXRp
YyB1MzIgcnZfamFscih1OCByZCwgdTggcnMxLCB1MTYgaW1tMTFfMCkKK3sKKwlyZXR1cm4gcnZf
aV9pbnNuKGltbTExXzAsIHJzMSwgMCwgcmQsIDB4NjcpOworfQorCitzdGF0aWMgdTMyIHJ2X2Jl
cSh1OCByczEsIHU4IHJzMiwgdTE2IGltbTEyXzEpCit7CisJcmV0dXJuIHJ2X3NiX2luc24oaW1t
MTJfMSwgcnMyLCByczEsIDAsIDB4NjMpOworfQorCitzdGF0aWMgdTMyIHJ2X2JsdHUodTggcnMx
LCB1OCByczIsIHUxNiBpbW0xMl8xKQoreworCXJldHVybiBydl9zYl9pbnNuKGltbTEyXzEsIHJz
MiwgcnMxLCA2LCAweDYzKTsKK30KKworc3RhdGljIHUzMiBydl9iZ2V1KHU4IHJzMSwgdTggcnMy
LCB1MTYgaW1tMTJfMSkKK3sKKwlyZXR1cm4gcnZfc2JfaW5zbihpbW0xMl8xLCByczIsIHJzMSwg
NywgMHg2Myk7Cit9CisKK3N0YXRpYyB1MzIgcnZfYm5lKHU4IHJzMSwgdTggcnMyLCB1MTYgaW1t
MTJfMSkKK3sKKwlyZXR1cm4gcnZfc2JfaW5zbihpbW0xMl8xLCByczIsIHJzMSwgMSwgMHg2Myk7
Cit9CisKK3N0YXRpYyB1MzIgcnZfYmx0KHU4IHJzMSwgdTggcnMyLCB1MTYgaW1tMTJfMSkKK3sK
KwlyZXR1cm4gcnZfc2JfaW5zbihpbW0xMl8xLCByczIsIHJzMSwgNCwgMHg2Myk7Cit9CisKK3N0
YXRpYyB1MzIgcnZfYmdlKHU4IHJzMSwgdTggcnMyLCB1MTYgaW1tMTJfMSkKK3sKKwlyZXR1cm4g
cnZfc2JfaW5zbihpbW0xMl8xLCByczIsIHJzMSwgNSwgMHg2Myk7Cit9CisKK3N0YXRpYyB1MzIg
cnZfc2IodTggcnMxLCB1MTYgaW1tMTFfMCwgdTggcnMyKQoreworCXJldHVybiBydl9zX2luc24o
aW1tMTFfMCwgcnMyLCByczEsIDAsIDB4MjMpOworfQorCitzdGF0aWMgdTMyIHJ2X3NoKHU4IHJz
MSwgdTE2IGltbTExXzAsIHU4IHJzMikKK3sKKwlyZXR1cm4gcnZfc19pbnNuKGltbTExXzAsIHJz
MiwgcnMxLCAxLCAweDIzKTsKK30KKworc3RhdGljIHUzMiBydl9zdyh1OCByczEsIHUxNiBpbW0x
MV8wLCB1OCByczIpCit7CisJcmV0dXJuIHJ2X3NfaW5zbihpbW0xMV8wLCByczIsIHJzMSwgMiwg
MHgyMyk7Cit9CisKK3N0YXRpYyB1MzIgcnZfbGJ1KHU4IHJkLCB1MTYgaW1tMTFfMCwgdTggcnMx
KQoreworCXJldHVybiBydl9pX2luc24oaW1tMTFfMCwgcnMxLCA0LCByZCwgMHgwMyk7Cit9CisK
K3N0YXRpYyB1MzIgcnZfbGh1KHU4IHJkLCB1MTYgaW1tMTFfMCwgdTggcnMxKQoreworCXJldHVy
biBydl9pX2luc24oaW1tMTFfMCwgcnMxLCA1LCByZCwgMHgwMyk7Cit9CisKK3N0YXRpYyB1MzIg
cnZfbHcodTggcmQsIHUxNiBpbW0xMV8wLCB1OCByczEpCit7CisJcmV0dXJuIHJ2X2lfaW5zbihp
bW0xMV8wLCByczEsIDIsIHJkLCAweDAzKTsKK30KKworc3RhdGljIHUzMiBydl9hbW9hZGRfdyh1
OCByZCwgdTggcnMyLCB1OCByczEsIHU4IGFxLCB1OCBybCkKK3sKKwlyZXR1cm4gcnZfYW1vX2lu
c24oMCwgYXEsIHJsLCByczIsIHJzMSwgMiwgcmQsIDB4MmYpOworfQorCitzdGF0aWMgYm9vbCBp
c18xM2JfaW50KHMzMiB2YWwpCit7CisJcmV0dXJuIC0oMSA8PCAxMikgPD0gdmFsICYmIHZhbCA8
ICgxIDw8IDEyKTsKK30KKworc3RhdGljIGJvb2wgaXNfMjFiX2ludChzMzIgdmFsKQoreworCXJl
dHVybiAtKDFMIDw8IDIwKSA8PSB2YWwgJiYgdmFsIDwgKDFMIDw8IDIwKTsKK30KKworc3RhdGlj
IGludCBpc18xM2JfY2hlY2soaW50IG9mZiwgaW50IGluc24pCit7CisJaWYgKCFpc18xM2JfaW50
KG9mZikpIHsKKwkJcHJfZXJyKCJicGYtaml0OiBpbnNuPSVkIG9mZnNldD0lZCBub3Qgc3VwcG9y
dGVkIHlldCFcbiIsCisJCSAgICAgICBpbnNuLCBvZmYpOworCQlyZXR1cm4gLTE7CisJfQorCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IGlzXzIxYl9jaGVjayhpbnQgb2ZmLCBpbnQgaW5zbikK
K3sKKwlpZiAoIWlzXzIxYl9pbnQob2ZmKSkgeworCQlwcl9lcnIoImJwZi1qaXQ6IGluc249JWQg
b2Zmc2V0PSVkIG5vdCBzdXBwb3J0ZWQgeWV0IVxuIiwKKwkJICAgICAgIGluc24sIG9mZik7CisJ
CXJldHVybiAtMTsKKwl9CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGVtaXRfaW1tKGNv
bnN0IHM4IHJkLCBzMzIgaW1tLCBzdHJ1Y3QgcnZfaml0X2NvbnRleHQgKmN0eCkKK3sKKwl1MzIg
dXBwZXIgPSAoaW1tICsgKDEgPDwgMTEpKSA+PiAxMjsKKwl1MzIgbG93ZXIgPSBpbW0gJiAweGZm
ZjsKKworCWlmICh1cHBlcikgeworCQllbWl0KHJ2X2x1aShyZCwgdXBwZXIpLCBjdHgpOworCQll
bWl0KHJ2X2FkZGkocmQsIHJkLCBsb3dlciksIGN0eCk7CisJfSBlbHNlIHsKKwkJZW1pdChydl9h
ZGRpKHJkLCBSVl9SRUdfWkVSTywgbG93ZXIpLCBjdHgpOworCX0KK30KKworc3RhdGljIHZvaWQg
ZW1pdF9pbW0zMihjb25zdCBzOCAqcmQsIHMzMiBpbW0sIHN0cnVjdCBydl9qaXRfY29udGV4dCAq
Y3R4KQoreworCS8qIEVtaXQgaW1tZWRpYXRlIGludG8gbG93ZXIgYml0cyAqLworCWVtaXRfaW1t
KHJkWzFdLCBpbW0sIGN0eCk7CisKKwkvKiBTaWduLWV4dGVuZCBpbnRvIHVwcGVyIGJpdHMgKi8K
KwllbWl0KHJ2X2FkZGkocmRbMF0sIHJkWzFdLCAwKSwgY3R4KTsKKwllbWl0KHJ2X3NyYWkocmRb
MF0sIHJkWzBdLCAzMSksIGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGVtaXRfaW1tNjQoY29uc3Qg
czggKnJkLCBzMzIgaW1tX2hpLCBzMzIgaW1tX2xvLAorCQkgICAgICAgc3RydWN0IHJ2X2ppdF9j
b250ZXh0ICpjdHgpCit7CisJZW1pdF9pbW0ocmRbMV0sIGltbV9sbywgY3R4KTsKKwllbWl0X2lt
bShyZFswXSwgaW1tX2hpLCBjdHgpOworfQorCitzdGF0aWMgaW50IHJ2X29mZnNldChpbnQgYnBm
X3RvLCBpbnQgYnBmX2Zyb20sIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4KQoreworCWludCBm
cm9tID0gY3R4LT5vZmZzZXRbYnBmX2Zyb21dIC0gMSwgdG8gPSBjdHgtPm9mZnNldFticGZfdG9d
OworCisJcmV0dXJuICh0byAtIGZyb20pIDw8IDI7Cit9CisKK3N0YXRpYyBpbnQgZXBpbG9ndWVf
b2Zmc2V0KHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4KQoreworCWludCB0byA9IGN0eC0+ZXBp
bG9ndWVfb2Zmc2V0LCBmcm9tID0gY3R4LT5uaW5zbnM7CisKKwlyZXR1cm4gKHRvIC0gZnJvbSkg
PDwgMjsKK30KKworc3RhdGljIHZvaWQgYnVpbGRfZXBpbG9ndWUoc3RydWN0IHJ2X2ppdF9jb250
ZXh0ICpjdHgpCit7CisJaW50IHN0YWNrX2FkanVzdCA9IGN0eC0+c3RhY2tfc2l6ZSwgc3RvcmVf
b2Zmc2V0ID0gc3RhY2tfYWRqdXN0IC0gODsKKwljb25zdCBzOCAqcjAgPSBicGYycnYzMltCUEZf
UkVHXzBdOworCisJc3RvcmVfb2Zmc2V0IC09IDQgKiBCUEZfSklUX1NDUkFUQ0hfUkVHUzsKKwor
CS8qIFNldCByZXR1cm4gdmFsdWUuICovCisJZW1pdChydl9hZGRpKFJWX1JFR19BMCwgcjBbMV0s
IDApLCBjdHgpOworCWVtaXQocnZfYWRkaShSVl9SRUdfQTEsIHIwWzBdLCAwKSwgY3R4KTsKKwor
CS8qIFJlc3RvcmUgY2FsbGVlLXNhdmVkIHJlZ2lzdGVycy4gKi8KKwllbWl0KHJ2X2x3KFJWX1JF
R19SQSwgc3RvcmVfb2Zmc2V0IC0gMCwgUlZfUkVHX1NQKSwgY3R4KTsKKwllbWl0KHJ2X2x3KFJW
X1JFR19GUCwgc3RvcmVfb2Zmc2V0IC0gNCwgUlZfUkVHX1NQKSwgY3R4KTsKKwllbWl0KHJ2X2x3
KFJWX1JFR19TMSwgc3RvcmVfb2Zmc2V0IC0gOCwgUlZfUkVHX1NQKSwgY3R4KTsKKwllbWl0KHJ2
X2x3KFJWX1JFR19TMiwgc3RvcmVfb2Zmc2V0IC0gMTIsIFJWX1JFR19TUCksIGN0eCk7CisJZW1p
dChydl9sdyhSVl9SRUdfUzMsIHN0b3JlX29mZnNldCAtIDE2LCBSVl9SRUdfU1ApLCBjdHgpOwor
CWVtaXQocnZfbHcoUlZfUkVHX1M0LCBzdG9yZV9vZmZzZXQgLSAyMCwgUlZfUkVHX1NQKSwgY3R4
KTsKKwllbWl0KHJ2X2x3KFJWX1JFR19TNSwgc3RvcmVfb2Zmc2V0IC0gMjQsIFJWX1JFR19TUCks
IGN0eCk7CisJZW1pdChydl9sdyhSVl9SRUdfUzYsIHN0b3JlX29mZnNldCAtIDI4LCBSVl9SRUdf
U1ApLCBjdHgpOworCisJZW1pdChydl9hZGRpKFJWX1JFR19TUCwgUlZfUkVHX1NQLCBzdGFja19h
ZGp1c3QpLCBjdHgpOworCWVtaXQocnZfamFscihSVl9SRUdfWkVSTywgUlZfUkVHX1JBLCAwKSwg
Y3R4KTsKK30KKworc3RhdGljIGludCBydl9vZmZzZXRfY2hlY2soaW50ICpydm9mZiwgczE2IG9m
ZiwgaW50IGluc24sCisJCQkgICBzdHJ1Y3QgcnZfaml0X2NvbnRleHQgKmN0eCkKK3sKKwkqcnZv
ZmYgPSBydl9vZmZzZXQoaW5zbiArIG9mZiwgaW5zbiwgY3R4KTsKKwlyZXR1cm4gaXNfMTNiX2No
ZWNrKCpydm9mZiwgaW5zbik7Cit9CisKK3N0YXRpYyBib29sIGlzX3N0YWNrZWQoczggcmVnKQor
eworCXJldHVybiByZWcgPCAwOworfQorCitzdGF0aWMgY29uc3QgczggKnJ2MzJfYnBmX2dldF9y
ZWc2NChjb25zdCBzOCAqcmVnLCBjb25zdCBzOCAqdG1wLAorCQkJCSAgICBzdHJ1Y3QgcnZfaml0
X2NvbnRleHQgKmN0eCkKK3sKKwlpZiAoaXNfc3RhY2tlZChyZWdbMF0pKSB7CisJCWVtaXQocnZf
bHcodG1wWzBdLCByZWdbMF0sIFJWX1JFR19GUCksIGN0eCk7CisJCWVtaXQocnZfbHcodG1wWzFd
LCByZWdbMV0sIFJWX1JFR19GUCksIGN0eCk7CisJCXJlZyA9IHRtcDsKKwl9CisJcmV0dXJuIHJl
ZzsKK30KKworc3RhdGljIHZvaWQgcnYzMl9icGZfcHV0X3JlZzY0KGNvbnN0IHM4ICpyZWcsIGNv
bnN0IHM4ICpzcmMsCisJCQkgICAgICAgc3RydWN0IHJ2X2ppdF9jb250ZXh0ICpjdHgpCit7CisJ
aWYgKGlzX3N0YWNrZWQocmVnWzBdKSkgeworCQllbWl0KHJ2X3N3KFJWX1JFR19GUCwgcmVnWzBd
LCBzcmNbMF0pLCBjdHgpOworCQllbWl0KHJ2X3N3KFJWX1JFR19GUCwgcmVnWzFdLCBzcmNbMV0p
LCBjdHgpOworCX0KK30KKworc3RhdGljIGNvbnN0IHM4ICpydjMyX2JwZl9nZXRfcmVnMzIoY29u
c3QgczggKnJlZywgY29uc3QgczggKnRtcCwKKwkJCQkgICAgc3RydWN0IHJ2X2ppdF9jb250ZXh0
ICpjdHgpCit7CisJaWYgKGlzX3N0YWNrZWQocmVnWzFdKSkgeworCQllbWl0KHJ2X2x3KHRtcFsx
XSwgcmVnWzFdLCBSVl9SRUdfRlApLCBjdHgpOworCQlyZWcgPSB0bXA7CisJfQorCXJldHVybiBy
ZWc7Cit9CisKK3N0YXRpYyB2b2lkIHJ2MzJfYnBmX3B1dF9yZWczMihjb25zdCBzOCAqcmVnLCBj
b25zdCBzOCAqc3JjLAorCQkJICAgICAgIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4KQorewor
CWlmIChpc19zdGFja2VkKHJlZ1sxXSkpIHsKKwkJZW1pdChydl9zdyhSVl9SRUdfRlAsIHJlZ1sx
XSwgc3JjWzFdKSwgY3R4KTsKKwkJZW1pdChydl9zdyhSVl9SRUdfRlAsIHJlZ1swXSwgUlZfUkVH
X1pFUk8pLCBjdHgpOworCX0gZWxzZSB7CisJCWVtaXQocnZfYWRkaShyZWdbMF0sIFJWX1JFR19a
RVJPLCAwKSwgY3R4KTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGVtaXRfcnYzMl9hbHVfaTY0KGNv
bnN0IHM4IGRzdFtdLCBzMzIgaW1tLAorCQkJICAgICAgc3RydWN0IHJ2X2ppdF9jb250ZXh0ICpj
dHgsCisJCQkgICAgICBjb25zdCB1OCBvcCkKK3sKKwljb25zdCBzOCAqdG1wMSA9IGJwZjJydjMy
W1RNUF9SRUdfMV07CisJY29uc3QgczggKnJkID0gcnYzMl9icGZfZ2V0X3JlZzY0KGRzdCwgdG1w
MSwgY3R4KTsKKworCXN3aXRjaCAob3ApIHsKKwljYXNlIEJQRl9NT1Y6CisJCWVtaXRfaW1tMzIo
cmQsIGltbSwgY3R4KTsKKwkJYnJlYWs7CisJfQorCisJcnYzMl9icGZfcHV0X3JlZzY0KGRzdCwg
cmQsIGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGVtaXRfcnYzMl9hbHVfaTMyKGNvbnN0IHM4IGRz
dFtdLCBzMzIgaW1tLAorCQkJICAgICAgc3RydWN0IHJ2X2ppdF9jb250ZXh0ICpjdHgsCisJCQkg
ICAgICBjb25zdCB1OCBvcCkKK3sKKwljb25zdCBzOCAqdG1wMSA9IGJwZjJydjMyW1RNUF9SRUdf
MV07CisJY29uc3QgczggKnJkID0gcnYzMl9icGZfZ2V0X3JlZzMyKGRzdCwgdG1wMSwgY3R4KTsK
KworCXN3aXRjaCAob3ApIHsKKwljYXNlIEJQRl9NT1Y6CisJCWVtaXRfaW1tMzIocmQsIGltbSwg
Y3R4KTsKKwkJYnJlYWs7CisJfQorCisJcnYzMl9icGZfcHV0X3JlZzMyKGRzdCwgcmQsIGN0eCk7
Cit9CisKK3N0YXRpYyB2b2lkIGVtaXRfcnYzMl9hbHVfcjY0KGNvbnN0IHM4IGRzdFtdLCBjb25z
dCBzOCBzcmNbXSwKKwkJCSAgICAgIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4LAorCQkJICAg
ICAgY29uc3QgdTggb3ApCit7CisJY29uc3QgczggKnRtcDEgPSBicGYycnYzMltUTVBfUkVHXzFd
OworCWNvbnN0IHM4ICp0bXAyID0gYnBmMnJ2MzJbVE1QX1JFR18yXTsKKwljb25zdCBzOCAqcmQg
PSBydjMyX2JwZl9nZXRfcmVnNjQoZHN0LCB0bXAxLCBjdHgpOworCWNvbnN0IHM4ICpycyA9IHJ2
MzJfYnBmX2dldF9yZWc2NChzcmMsIHRtcDIsIGN0eCk7CisKKwlzd2l0Y2ggKG9wKSB7CisJY2Fz
ZSBCUEZfTU9WOgorCQllbWl0KHJ2X2FkZGkocmRbMF0sIHJzWzBdLCAwKSwgY3R4KTsKKwkJZW1p
dChydl9hZGRpKHJkWzFdLCByc1sxXSwgMCksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0FE
RDoKKwkJZW1pdChydl9hZGRpKFJWX1JFR19UMCwgcmRbMV0sIDApLCBjdHgpOworCQllbWl0KHJ2
X2FkZChyZFsxXSwgcmRbMV0sIHJzWzFdKSwgY3R4KTsKKwkJZW1pdChydl9zbHR1KFJWX1JFR19U
MCwgcmRbMV0sIFJWX1JFR19UMCksIGN0eCk7CisJCWVtaXQocnZfYWRkKHJkWzBdLCByZFswXSwg
cnNbMF0pLCBjdHgpOworCQllbWl0KHJ2X2FkZChyZFswXSwgcmRbMF0sIFJWX1JFR19UMCksIGN0
eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX1NVQjoKKwkJZW1pdChydl9hZGRpKFJWX1JFR19UMCwg
cmRbMV0sIDApLCBjdHgpOworCQllbWl0KHJ2X3N1YihyZFsxXSwgcmRbMV0sIHJzWzFdKSwgY3R4
KTsKKwkJZW1pdChydl9zbHR1KFJWX1JFR19UMCwgUlZfUkVHX1QwLCByZFsxXSksIGN0eCk7CisJ
CWVtaXQocnZfc3ViKHJkWzBdLCByZFswXSwgcnNbMF0pLCBjdHgpOworCQllbWl0KHJ2X3N1Yihy
ZFswXSwgcmRbMF0sIFJWX1JFR19UMCksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0FORDoK
KwkJZW1pdChydl9hbmQocmRbMF0sIHJkWzBdLCByc1swXSksIGN0eCk7CisJCWVtaXQocnZfYW5k
KHJkWzFdLCByZFsxXSwgcnNbMV0pLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9PUjoKKwkJ
ZW1pdChydl9vcihyZFswXSwgcmRbMF0sIHJzWzBdKSwgY3R4KTsKKwkJZW1pdChydl9vcihyZFsx
XSwgcmRbMV0sIHJzWzFdKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBCUEZfWE9SOgorCQllbWl0
KHJ2X3hvcihyZFswXSwgcmRbMF0sIHJzWzBdKSwgY3R4KTsKKwkJZW1pdChydl94b3IocmRbMV0s
IHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX01VTDoKKwkJZW1pdChy
dl9tdWwoUlZfUkVHX1QwLCByc1swXSwgcmRbMV0pLCBjdHgpOworCQllbWl0KHJ2X211bChyZFsw
XSwgcmRbMF0sIHJzWzFdKSwgY3R4KTsKKwkJZW1pdChydl9tdWxodShSVl9SRUdfVDEsIHJkWzFd
LCByc1sxXSksIGN0eCk7CisJCWVtaXQocnZfYWRkKHJkWzBdLCByZFswXSwgUlZfUkVHX1QwKSwg
Y3R4KTsKKwkJZW1pdChydl9tdWwocmRbMV0sIHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWVtaXQo
cnZfYWRkKHJkWzBdLCByZFswXSwgUlZfUkVHX1QxKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBC
UEZfTFNIOgorCQllbWl0KHJ2X2FkZGkoUlZfUkVHX1QwLCByc1sxXSwgLTMyKSwgY3R4KTsKKwkJ
ZW1pdChydl9ibHQoUlZfUkVHX1QwLCBSVl9SRUdfWkVSTywgMTYgPj4gMSksIGN0eCk7CisKKwkJ
ZW1pdChydl9zbGwocmRbMF0sIHJkWzFdLCBSVl9SRUdfVDApLCBjdHgpOworCQllbWl0KHJ2X2Fk
ZGkocmRbMV0sIFJWX1JFR19aRVJPLCAwKSwgY3R4KTsKKwkJZW1pdChydl9qYWwoUlZfUkVHX1pF
Uk8sIDMyID4+IDEpLCBjdHgpOworCisJCWVtaXQocnZfYWRkaShSVl9SRUdfVDEsIFJWX1JFR19a
RVJPLCAzMSksIGN0eCk7CisJCWVtaXQocnZfc3JsaShSVl9SRUdfVDAsIHJkWzFdLCAxKSwgY3R4
KTsKKwkJZW1pdChydl9zdWIoUlZfUkVHX1QxLCBSVl9SRUdfVDEsIHJzWzFdKSwgY3R4KTsKKwkJ
ZW1pdChydl9zcmwoUlZfUkVHX1QwLCBSVl9SRUdfVDAsIFJWX1JFR19UMSksIGN0eCk7CisJCWVt
aXQocnZfc2xsKHJkWzBdLCByZFswXSwgcnNbMV0pLCBjdHgpOworCQllbWl0KHJ2X29yKHJkWzBd
LCBSVl9SRUdfVDAsIHJkWzBdKSwgY3R4KTsKKwkJZW1pdChydl9zbGwocmRbMV0sIHJkWzFdLCBy
c1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX1JTSDoKKwkJZW1pdChydl9hZGRpKFJW
X1JFR19UMCwgcnNbMV0sIC0zMiksIGN0eCk7CisJCWVtaXQocnZfYmx0KFJWX1JFR19UMCwgUlZf
UkVHX1pFUk8sIDE2ID4+IDEpLCBjdHgpOworCisJCWVtaXQocnZfc3JsKHJkWzFdLCByZFswXSwg
UlZfUkVHX1QwKSwgY3R4KTsKKwkJZW1pdChydl9hZGRpKHJkWzBdLCBSVl9SRUdfWkVSTywgMCks
IGN0eCk7CisJCWVtaXQocnZfamFsKFJWX1JFR19aRVJPLCAzMiA+PiAxKSwgY3R4KTsKKworCQll
bWl0KHJ2X2FkZGkoUlZfUkVHX1QxLCBSVl9SRUdfWkVSTywgMzEpLCBjdHgpOworCQllbWl0KHJ2
X3NsbGkoUlZfUkVHX1QwLCByZFswXSwgMSksIGN0eCk7CisJCWVtaXQocnZfc3ViKFJWX1JFR19U
MSwgUlZfUkVHX1QxLCByc1sxXSksIGN0eCk7CisJCWVtaXQocnZfc2xsKFJWX1JFR19UMCwgUlZf
UkVHX1QwLCBSVl9SRUdfVDEpLCBjdHgpOworCQllbWl0KHJ2X3NybChyZFsxXSwgcmRbMV0sIHJz
WzFdKSwgY3R4KTsKKwkJZW1pdChydl9vcihyZFsxXSwgUlZfUkVHX1QwLCByZFsxXSksIGN0eCk7
CisJCWVtaXQocnZfc3JsKHJkWzBdLCByZFswXSwgcnNbMV0pLCBjdHgpOworCQlicmVhazsKKwlj
YXNlIEJQRl9BUlNIOgorCQllbWl0KHJ2X2FkZGkoUlZfUkVHX1QwLCByc1sxXSwgLTMyKSwgY3R4
KTsKKwkJZW1pdChydl9ibHQoUlZfUkVHX1QwLCBSVl9SRUdfWkVSTywgMTYgPj4gMSksIGN0eCk7
CisKKwkJZW1pdChydl9zcmEocmRbMV0sIHJkWzBdLCBSVl9SRUdfVDApLCBjdHgpOworCQllbWl0
KHJ2X3NyYWkocmRbMF0sIHJkWzBdLCAweDFmKSwgY3R4KTsKKwkJZW1pdChydl9qYWwoUlZfUkVH
X1pFUk8sIDMyID4+IDEpLCBjdHgpOworCisJCWVtaXQocnZfYWRkaShSVl9SRUdfVDEsIFJWX1JF
R19aRVJPLCAzMSksIGN0eCk7CisJCWVtaXQocnZfc2xsaShSVl9SRUdfVDAsIHJkWzBdLCAxKSwg
Y3R4KTsKKwkJZW1pdChydl9zdWIoUlZfUkVHX1QxLCBSVl9SRUdfVDEsIHJzWzFdKSwgY3R4KTsK
KwkJZW1pdChydl9zbGwoUlZfUkVHX1QwLCBSVl9SRUdfVDAsIFJWX1JFR19UMSksIGN0eCk7CisJ
CWVtaXQocnZfc3JsKHJkWzFdLCByZFsxXSwgcnNbMV0pLCBjdHgpOworCQllbWl0KHJ2X29yKHJk
WzFdLCBSVl9SRUdfVDAsIHJkWzFdKSwgY3R4KTsKKwkJZW1pdChydl9zcmEocmRbMF0sIHJkWzBd
LCByc1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX05FRzoKKwkJZW1pdChydl9zdWIo
cmRbMV0sIFJWX1JFR19aRVJPLCByZFsxXSksIGN0eCk7CisJCWVtaXQocnZfc2x0dShSVl9SRUdf
VDAsIFJWX1JFR19aRVJPLCByZFsxXSksIGN0eCk7CisJCWVtaXQocnZfc3ViKHJkWzBdLCBSVl9S
RUdfWkVSTywgcmRbMF0pLCBjdHgpOworCQllbWl0KHJ2X3N1YihyZFswXSwgcmRbMF0sIFJWX1JF
R19UMCksIGN0eCk7CisJCWJyZWFrOworCX0KKworCXJ2MzJfYnBmX3B1dF9yZWc2NChkc3QsIHJk
LCBjdHgpOworfQorCitzdGF0aWMgdm9pZCBlbWl0X3J2MzJfYWx1X3IzMihjb25zdCBzOCBkc3Rb
XSwgY29uc3Qgczggc3JjW10sCisJCQkgICAgICBzdHJ1Y3QgcnZfaml0X2NvbnRleHQgKmN0eCwK
KwkJCSAgICAgIGNvbnN0IHU4IG9wKQoreworCWNvbnN0IHM4ICp0bXAxID0gYnBmMnJ2MzJbVE1Q
X1JFR18xXTsKKwljb25zdCBzOCAqdG1wMiA9IGJwZjJydjMyW1RNUF9SRUdfMl07CisJY29uc3Qg
czggKnJkID0gcnYzMl9icGZfZ2V0X3JlZzMyKGRzdCwgdG1wMSwgY3R4KTsKKwljb25zdCBzOCAq
cnMgPSBydjMyX2JwZl9nZXRfcmVnMzIoc3JjLCB0bXAyLCBjdHgpOworCisJc3dpdGNoIChvcCkg
eworCWNhc2UgQlBGX01PVjoKKwkJZW1pdChydl9hZGRpKHJkWzFdLCByc1sxXSwgMCksIGN0eCk7
CisJCWJyZWFrOworCWNhc2UgQlBGX0FERDoKKwkJZW1pdChydl9hZGQocmRbMV0sIHJkWzFdLCBy
c1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX1NVQjoKKwkJZW1pdChydl9zdWIocmRb
MV0sIHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0FORDoKKwkJZW1p
dChydl9hbmQocmRbMV0sIHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBG
X09SOgorCQllbWl0KHJ2X29yKHJkWzFdLCByZFsxXSwgcnNbMV0pLCBjdHgpOworCQlicmVhazsK
KwljYXNlIEJQRl9YT1I6CisJCWVtaXQocnZfeG9yKHJkWzFdLCByZFsxXSwgcnNbMV0pLCBjdHgp
OworCQlicmVhazsKKwljYXNlIEJQRl9NVUw6CisJCWVtaXQocnZfbXVsKHJkWzFdLCByZFsxXSwg
cnNbMV0pLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9ESVY6CisJCWVtaXQocnZfZGl2dShy
ZFsxXSwgcmRbMV0sIHJzWzFdKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBCUEZfTU9EOgorCQll
bWl0KHJ2X3JlbXUocmRbMV0sIHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWJyZWFrOworCWNhc2Ug
QlBGX0xTSDoKKwkJZW1pdChydl9zbGwocmRbMV0sIHJkWzFdLCByc1sxXSksIGN0eCk7CisJCWJy
ZWFrOworCWNhc2UgQlBGX1JTSDoKKwkJZW1pdChydl9zcmwocmRbMV0sIHJkWzFdLCByc1sxXSks
IGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0FSU0g6CisJCWVtaXQocnZfc3JhKHJkWzFdLCBy
ZFsxXSwgcnNbMV0pLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9ORUc6CisJCWVtaXQocnZf
c3ViKHJkWzFdLCBSVl9SRUdfWkVSTywgcmRbMV0pLCBjdHgpOworCQlicmVhazsKKwl9CisKKwly
djMyX2JwZl9wdXRfcmVnMzIoZHN0LCByZCwgY3R4KTsKK30KKworc3RhdGljIGludCBlbWl0X3J2
MzJfanVtcF9yNjQoY29uc3Qgczggc3JjMVtdLCBjb25zdCBzOCBzcmMyW10sCisJCQkgICAgICBz
MTYgb2ZmLCBpbnQgaW5zbiwKKwkJCSAgICAgIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4LAor
CQkJICAgICAgY29uc3QgdTggb3ApCit7CisJaW50IHJ2b2ZmOworCWNvbnN0IHM4ICp0bXAxID0g
YnBmMnJ2MzJbVE1QX1JFR18xXTsKKwljb25zdCBzOCAqdG1wMiA9IGJwZjJydjMyW1RNUF9SRUdf
Ml07CisJY29uc3QgczggKnJzMSA9IHJ2MzJfYnBmX2dldF9yZWc2NChzcmMxLCB0bXAxLCBjdHgp
OworCWNvbnN0IHM4ICpyczIgPSBydjMyX2JwZl9nZXRfcmVnNjQoc3JjMiwgdG1wMiwgY3R4KTsK
KworCWlmIChydl9vZmZzZXRfY2hlY2soJnJ2b2ZmLCBvZmYsIGluc24sIGN0eCkpCisJCXJldHVy
biAtMTsKKworCXN3aXRjaCAob3ApIHsKKwljYXNlIEJQRl9KRVE6CisJCWVtaXQocnZfYm5lKHJz
MVswXSwgcnMyWzBdLCA4ID4+IDEpLCBjdHgpOworCQllbWl0KHJ2X2JlcShyczFbMV0sIHJzMlsx
XSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0pORToKKwkJZW1pdChy
dl9ibmUocnMxWzBdLCByczJbMF0sIChydm9mZiArIDQpID4+IDEpLCBjdHgpOworCQllbWl0KHJ2
X2JuZShyczFbMV0sIHJzMlsxXSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2Ug
QlBGX0pMRToKKwkJZW1pdChydl9ibHR1KHJzMVswXSwgcnMyWzBdLCAocnZvZmYgKyA4KSA+PiAx
KSwgY3R4KTsKKwkJZW1pdChydl9ibHR1KHJzMlswXSwgcnMxWzBdLCA4ID4+IDEpLCBjdHgpOwor
CQllbWl0KHJ2X2JnZXUocnMyWzFdLCByczFbMV0sIHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVh
azsKKwljYXNlIEJQRl9KTFQ6CisJCWVtaXQocnZfYmx0dShyczFbMF0sIHJzMlswXSwgKHJ2b2Zm
ICsgOCkgPj4gMSksIGN0eCk7CisJCWVtaXQocnZfYmx0dShyczJbMF0sIHJzMVswXSwgOCA+PiAx
KSwgY3R4KTsKKwkJZW1pdChydl9ibHR1KHJzMVsxXSwgcnMyWzFdLCBydm9mZiA+PiAxKSwgY3R4
KTsKKwkJYnJlYWs7CisJY2FzZSBCUEZfSkdFOgorCQllbWl0KHJ2X2JsdHUocnMyWzBdLCByczFb
MF0sIChydm9mZiArIDgpID4+IDEpLCBjdHgpOworCQllbWl0KHJ2X2JsdHUocnMxWzBdLCByczJb
MF0sIDggPj4gMSksIGN0eCk7CisJCWVtaXQocnZfYmdldShyczFbMV0sIHJzMlsxXSwgcnZvZmYg
Pj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0pHVDoKKwkJZW1pdChydl9ibHR1KHJz
MlswXSwgcnMxWzBdLCAocnZvZmYgKyA4KSA+PiAxKSwgY3R4KTsKKwkJZW1pdChydl9ibHR1KHJz
MVswXSwgcnMyWzBdLCA4ID4+IDEpLCBjdHgpOworCQllbWl0KHJ2X2JsdHUocnMyWzFdLCByczFb
MV0sIHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9KU0xFOgorCQllbWl0
KHJ2X2JsdChyczFbMF0sIHJzMlswXSwgKHJ2b2ZmICsgOCkgPj4gMSksIGN0eCk7CisJCWVtaXQo
cnZfYm5lKHJzMlswXSwgcnMxWzBdLCA4ID4+IDEpLCBjdHgpOworCQllbWl0KHJ2X2JnZXUocnMy
WzFdLCByczFbMV0sIHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9KU0xU
OgorCQllbWl0KHJ2X2JsdChyczFbMF0sIHJzMlswXSwgKHJ2b2ZmICsgOCkgPj4gMSksIGN0eCk7
CisJCWVtaXQocnZfYm5lKHJzMlswXSwgcnMxWzBdLCA4ID4+IDEpLCBjdHgpOworCQllbWl0KHJ2
X2JsdHUocnMxWzFdLCByczJbMV0sIHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNl
IEJQRl9KU0dFOgorCQllbWl0KHJ2X2JsdChyczJbMF0sIHJzMVswXSwgKHJ2b2ZmICsgOCkgPj4g
MSksIGN0eCk7CisJCWVtaXQocnZfYm5lKHJzMVswXSwgcnMyWzBdLCA4ID4+IDEpLCBjdHgpOwor
CQllbWl0KHJ2X2JnZXUocnMxWzFdLCByczJbMV0sIHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVh
azsKKwljYXNlIEJQRl9KU0dUOgorCQllbWl0KHJ2X2JsdChyczJbMF0sIHJzMVswXSwgKHJ2b2Zm
ICsgOCkgPj4gMSksIGN0eCk7CisJCWVtaXQocnZfYm5lKHJzMVswXSwgcnMyWzBdLCA4ID4+IDEp
LCBjdHgpOworCQllbWl0KHJ2X2JsdHUocnMyWzFdLCByczFbMV0sIHJ2b2ZmID4+IDEpLCBjdHgp
OworCQlicmVhazsKKwljYXNlIEJQRl9KU0VUOgorCQllbWl0KHJ2X2FuZChSVl9SRUdfVDAsIHJz
MVswXSwgcnMyWzBdKSwgY3R4KTsKKwkJZW1pdChydl9ibmUoUlZfUkVHX1QwLCBSVl9SRUdfWkVS
TywgKHJ2b2ZmICsgOCkgPj4gMSksIGN0eCk7CisJCWVtaXQocnZfYW5kKFJWX1JFR19UMCwgcnMx
WzFdLCByczJbMV0pLCBjdHgpOworCQllbWl0KHJ2X2JuZShSVl9SRUdfVDAsIFJWX1JFR19aRVJP
LCBydm9mZiA+PiAxKSwgY3R4KTsKKwkJYnJlYWs7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgZW1pdF9ydjMyX2p1bXBfcjMyKGNvbnN0IHM4IHNyYzFbXSwgY29uc3Qgczggc3Jj
MltdLAorCQkJICAgICAgczE2IG9mZiwgaW50IGluc24sCisJCQkgICAgICBzdHJ1Y3QgcnZfaml0
X2NvbnRleHQgKmN0eCwKKwkJCSAgICAgIGNvbnN0IHU4IG9wKQoreworCWludCBydm9mZjsKKwlj
b25zdCBzOCAqdG1wMSA9IGJwZjJydjMyW1RNUF9SRUdfMV07CisJY29uc3QgczggKnRtcDIgPSBi
cGYycnYzMltUTVBfUkVHXzJdOworCWNvbnN0IHM4ICpyczEgPSBydjMyX2JwZl9nZXRfcmVnMzIo
c3JjMSwgdG1wMSwgY3R4KTsKKwljb25zdCBzOCAqcnMyID0gcnYzMl9icGZfZ2V0X3JlZzMyKHNy
YzIsIHRtcDIsIGN0eCk7CisKKwlpZiAocnZfb2Zmc2V0X2NoZWNrKCZydm9mZiwgb2ZmLCBpbnNu
LCBjdHgpKQorCQlyZXR1cm4gLTE7CisKKwlzd2l0Y2ggKG9wKSB7CisJY2FzZSBCUEZfSkVROgor
CQllbWl0KHJ2X2JlcShyczFbMV0sIHJzMlsxXSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFr
OworCWNhc2UgQlBGX0pORToKKwkJZW1pdChydl9ibmUocnMxWzFdLCByczJbMV0sIHJ2b2ZmID4+
IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9KTEU6CisJCWVtaXQocnZfYmdldShyczJb
MV0sIHJzMVsxXSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0pMVDoK
KwkJZW1pdChydl9ibHR1KHJzMVsxXSwgcnMyWzFdLCBydm9mZiA+PiAxKSwgY3R4KTsKKwkJYnJl
YWs7CisJY2FzZSBCUEZfSkdFOgorCQllbWl0KHJ2X2JnZXUocnMxWzFdLCByczJbMV0sIHJ2b2Zm
ID4+IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9KR1Q6CisJCWVtaXQocnZfYmx0dShy
czJbMV0sIHJzMVsxXSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0pT
TEU6CisJCWVtaXQocnZfYmdlKHJzMlsxXSwgcnMxWzFdLCBydm9mZiA+PiAxKSwgY3R4KTsKKwkJ
YnJlYWs7CisJY2FzZSBCUEZfSlNMVDoKKwkJZW1pdChydl9ibHQocnMxWzFdLCByczJbMV0sIHJ2
b2ZmID4+IDEpLCBjdHgpOworCQlicmVhazsKKwljYXNlIEJQRl9KU0dFOgorCQllbWl0KHJ2X2Jn
ZShyczFbMV0sIHJzMlsxXSwgcnZvZmYgPj4gMSksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBG
X0pTR1Q6CisJCWVtaXQocnZfYmx0KHJzMlsxXSwgcnMxWzFdLCBydm9mZiA+PiAxKSwgY3R4KTsK
KwkJYnJlYWs7CisJY2FzZSBCUEZfSlNFVDoKKwkJZW1pdChydl9hbmQoUlZfUkVHX1QwLCByczFb
MV0sIHJzMlsxXSksIGN0eCk7CisJCWVtaXQocnZfYm5lKFJWX1JFR19UMCwgUlZfUkVHX1pFUk8s
IHJ2b2ZmID4+IDEpLCBjdHgpOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCBlbWl0X3J2MzJfbG9hZF9yNjQoY29uc3QgczggZHN0W10sIGNvbnN0IHM4IHNyY1td
LAorCQkJICAgICAgczE2IG9mZiwKKwkJCSAgICAgIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4
LAorCQkJICAgICAgY29uc3QgdTggc2l6ZSkKK3sKKwljb25zdCBzOCAqdG1wMSA9IGJwZjJydjMy
W1RNUF9SRUdfMV07CisJY29uc3QgczggKnRtcDIgPSBicGYycnYzMltUTVBfUkVHXzJdOworCWNv
bnN0IHM4ICpyZCA9IHJ2MzJfYnBmX2dldF9yZWc2NChkc3QsIHRtcDEsIGN0eCk7CisJY29uc3Qg
czggKnJzID0gcnYzMl9icGZfZ2V0X3JlZzY0KHNyYywgdG1wMiwgY3R4KTsKKworCWVtaXRfaW1t
KFJWX1JFR19UMCwgb2ZmLCBjdHgpOworCWVtaXQocnZfYWRkKFJWX1JFR19UMCwgUlZfUkVHX1Qw
LCByc1sxXSksIGN0eCk7CisKKwlzd2l0Y2ggKHNpemUpIHsKKwljYXNlIEJQRl9COgorCQllbWl0
KHJ2X2xidShyZFsxXSwgMCwgUlZfUkVHX1QwKSwgY3R4KTsKKwkJZW1pdChydl9hZGRpKHJkWzBd
LCBSVl9SRUdfWkVSTywgMCksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0g6CisJCWVtaXQo
cnZfbGh1KHJkWzFdLCAwLCBSVl9SRUdfVDApLCBjdHgpOworCQllbWl0KHJ2X2FkZGkocmRbMF0s
IFJWX1JFR19aRVJPLCAwKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBCUEZfVzoKKwkJZW1pdChy
dl9sdyhyZFsxXSwgMCwgUlZfUkVHX1QwKSwgY3R4KTsKKwkJZW1pdChydl9hZGRpKHJkWzBdLCBS
Vl9SRUdfWkVSTywgMCksIGN0eCk7CisJCWJyZWFrOworCWNhc2UgQlBGX0RXOgorCQllbWl0KHJ2
X2x3KHJkWzFdLCAwLCBSVl9SRUdfVDApLCBjdHgpOworCQllbWl0KHJ2X2x3KHJkWzBdLCA0LCBS
Vl9SRUdfVDApLCBjdHgpOworCQlicmVhazsKKwl9CisKKwlydjMyX2JwZl9wdXRfcmVnNjQoZHN0
LCByZCwgY3R4KTsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBlbWl0X3J2MzJfc3RvcmVf
cjY0KGNvbnN0IHM4IGRzdFtdLCBjb25zdCBzOCBzcmNbXSwKKwkJCSAgICAgICBzMTYgb2ZmLAor
CQkJICAgICAgIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4LAorCQkJICAgICAgIGNvbnN0IHU4
IHNpemUsIGNvbnN0IHU4IG1vZGUpCit7CisJY29uc3QgczggKnRtcDEgPSBicGYycnYzMltUTVBf
UkVHXzFdOworCWNvbnN0IHM4ICp0bXAyID0gYnBmMnJ2MzJbVE1QX1JFR18yXTsKKwljb25zdCBz
OCAqcmQgPSBydjMyX2JwZl9nZXRfcmVnNjQoZHN0LCB0bXAxLCBjdHgpOworCWNvbnN0IHM4ICpy
cyA9IHJ2MzJfYnBmX2dldF9yZWc2NChzcmMsIHRtcDIsIGN0eCk7CisKKwlpZiAobW9kZSA9PSBC
UEZfWEFERCAmJiBzaXplICE9IEJQRl9XKQorCQlyZXR1cm4gLTE7CisKKwllbWl0X2ltbShSVl9S
RUdfVDAsIG9mZiwgY3R4KTsKKwllbWl0KHJ2X2FkZChSVl9SRUdfVDAsIFJWX1JFR19UMCwgcmRb
MV0pLCBjdHgpOworCisJc3dpdGNoIChzaXplKSB7CisJY2FzZSBCUEZfQjoKKwkJZW1pdChydl9z
YihSVl9SRUdfVDAsIDAsIHJzWzFdKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBCUEZfSDoKKwkJ
ZW1pdChydl9zaChSVl9SRUdfVDAsIDAsIHJzWzFdKSwgY3R4KTsKKwkJYnJlYWs7CisJY2FzZSBC
UEZfVzoKKwkJc3dpdGNoIChtb2RlKSB7CisJCWNhc2UgQlBGX01FTToKKwkJCWVtaXQocnZfc3co
UlZfUkVHX1QwLCAwLCByc1sxXSksIGN0eCk7CisJCQlicmVhazsKKwkJY2FzZSBCUEZfWEFERDoK
KwkJCWVtaXQocnZfYW1vYWRkX3coUlZfUkVHX1pFUk8sIHJzWzFdLCBSVl9SRUdfVDAsIDAsIDAp
LCBjdHgpOworCQkJYnJlYWs7CisJCX0KKwkJYnJlYWs7CisJY2FzZSBCUEZfRFc6CisJCWVtaXQo
cnZfc3coUlZfUkVHX1QwLCAwLCByc1sxXSksIGN0eCk7CisJCWVtaXQocnZfc3coUlZfUkVHX1Qw
LCA0LCByc1swXSksIGN0eCk7CisJCWJyZWFrOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0
aWMgdm9pZCBlbWl0X3J2MzJfcmV2MTYoY29uc3QgczggcmQsIHN0cnVjdCBydl9qaXRfY29udGV4
dCAqY3R4KQoreworCWVtaXQocnZfYWRkaShSVl9SRUdfVDEsIFJWX1JFR19aRVJPLCAwKSwgY3R4
KTsKKworCWVtaXQocnZfYW5kaShSVl9SRUdfVDAsIHJkLCAweGZmKSwgY3R4KTsKKwllbWl0KHJ2
X2FkZChSVl9SRUdfVDEsIFJWX1JFR19UMSwgUlZfUkVHX1QwKSwgY3R4KTsKKwllbWl0KHJ2X3Ns
bGkoUlZfUkVHX1QxLCBSVl9SRUdfVDEsIDgpLCBjdHgpOworCWVtaXQocnZfc3JsaShyZCwgcmQs
IDgpLCBjdHgpOworCisJZW1pdChydl9hbmRpKFJWX1JFR19UMCwgcmQsIDB4ZmYpLCBjdHgpOwor
CWVtaXQocnZfYWRkKFJWX1JFR19UMSwgUlZfUkVHX1QxLCBSVl9SRUdfVDApLCBjdHgpOworCisJ
ZW1pdChydl9hZGRpKHJkLCBSVl9SRUdfVDEsIDApLCBjdHgpOworfQorCitzdGF0aWMgdm9pZCBl
bWl0X3J2MzJfcmV2MzIoY29uc3QgczggcmQsIHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4KQor
eworCWVtaXQocnZfYWRkaShSVl9SRUdfVDEsIFJWX1JFR19aRVJPLCAwKSwgY3R4KTsKKworCWVt
aXQocnZfYW5kaShSVl9SRUdfVDAsIHJkLCAweGZmKSwgY3R4KTsKKwllbWl0KHJ2X2FkZChSVl9S
RUdfVDEsIFJWX1JFR19UMSwgUlZfUkVHX1QwKSwgY3R4KTsKKwllbWl0KHJ2X3NsbGkoUlZfUkVH
X1QxLCBSVl9SRUdfVDEsIDgpLCBjdHgpOworCWVtaXQocnZfc3JsaShyZCwgcmQsIDgpLCBjdHgp
OworCisJZW1pdChydl9hbmRpKFJWX1JFR19UMCwgcmQsIDB4ZmYpLCBjdHgpOworCWVtaXQocnZf
YWRkKFJWX1JFR19UMSwgUlZfUkVHX1QxLCBSVl9SRUdfVDApLCBjdHgpOworCWVtaXQocnZfc2xs
aShSVl9SRUdfVDEsIFJWX1JFR19UMSwgOCksIGN0eCk7CisJZW1pdChydl9zcmxpKHJkLCByZCwg
OCksIGN0eCk7CisKKwllbWl0KHJ2X2FuZGkoUlZfUkVHX1QwLCByZCwgMHhmZiksIGN0eCk7CisJ
ZW1pdChydl9hZGQoUlZfUkVHX1QxLCBSVl9SRUdfVDEsIFJWX1JFR19UMCksIGN0eCk7CisJZW1p
dChydl9zbGxpKFJWX1JFR19UMSwgUlZfUkVHX1QxLCA4KSwgY3R4KTsKKwllbWl0KHJ2X3NybGko
cmQsIHJkLCA4KSwgY3R4KTsKKwllbWl0KHJ2X2FuZGkoUlZfUkVHX1QwLCByZCwgMHhmZiksIGN0
eCk7CisJZW1pdChydl9hZGQoUlZfUkVHX1QxLCBSVl9SRUdfVDEsIFJWX1JFR19UMCksIGN0eCk7
CisKKwllbWl0KHJ2X2FkZGkocmQsIFJWX1JFR19UMSwgMCksIGN0eCk7Cit9CisKK3N0YXRpYyBp
bnQgZW1pdF9pbnNuKGNvbnN0IHN0cnVjdCBicGZfaW5zbiAqaW5zbiwKKwkJICAgICBzdHJ1Y3Qg
cnZfaml0X2NvbnRleHQgKmN0eCwKKwkJICAgICBib29sIGV4dHJhX3Bhc3MpCit7CisJaW50IHJ2
b2ZmLCBpID0gaW5zbiAtIGN0eC0+cHJvZy0+aW5zbnNpOworCXU4IGNvZGUgPSBpbnNuLT5jb2Rl
OworCXMxNiBvZmYgPSBpbnNuLT5vZmY7CisJczMyIGltbSA9IGluc24tPmltbTsKKworCWNvbnN0
IHM4ICpkc3QgPSBicGYycnYzMltpbnNuLT5kc3RfcmVnXTsKKwljb25zdCBzOCAqc3JjID0gYnBm
MnJ2MzJbaW5zbi0+c3JjX3JlZ107CisJY29uc3QgczggKnRtcDEgPSBicGYycnYzMltUTVBfUkVH
XzFdOworCWNvbnN0IHM4ICp0bXAyID0gYnBmMnJ2MzJbVE1QX1JFR18yXTsKKworCXN3aXRjaCAo
Y29kZSkgeworCWNhc2UgQlBGX0FMVTY0IHwgQlBGX01PViB8IEJQRl9YOgorCisJY2FzZSBCUEZf
QUxVNjQgfCBCUEZfQUREIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVNjQgfCBCUEZfQUREIHwgQlBG
X0s6CisKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9TVUIgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFU2
NCB8IEJQRl9TVUIgfCBCUEZfSzoKKworCWNhc2UgQlBGX0FMVTY0IHwgQlBGX0FORCB8IEJQRl9Y
OgorCWNhc2UgQlBGX0FMVTY0IHwgQlBGX0FORCB8IEJQRl9LOgorCisJY2FzZSBCUEZfQUxVNjQg
fCBCUEZfT1IgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9PUiB8IEJQRl9LOgorCisJ
Y2FzZSBCUEZfQUxVNjQgfCBCUEZfWE9SIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVNjQgfCBCUEZf
WE9SIHwgQlBGX0s6CisKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9NVUwgfCBCUEZfWDoKKwljYXNl
IEJQRl9BTFU2NCB8IEJQRl9NVUwgfCBCUEZfSzoKKworCWNhc2UgQlBGX0FMVTY0IHwgQlBGX0xT
SCB8IEJQRl9YOgorCWNhc2UgQlBGX0FMVTY0IHwgQlBGX0xTSCB8IEJQRl9LOgorCisJY2FzZSBC
UEZfQUxVNjQgfCBCUEZfUlNIIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVNjQgfCBCUEZfUlNIIHwg
QlBGX0s6CisKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9BUlNIIHwgQlBGX1g6CisJY2FzZSBCUEZf
QUxVNjQgfCBCUEZfQVJTSCB8IEJQRl9LOgorCQlpZiAoQlBGX1NSQyhjb2RlKSA9PSBCUEZfSykg
eworCQkJZW1pdF9pbW0zMih0bXAyLCBpbW0sIGN0eCk7CisJCQlzcmMgPSB0bXAyOworCQl9CisJ
CWVtaXRfcnYzMl9hbHVfcjY0KGRzdCwgc3JjLCBjdHgsIEJQRl9PUChjb2RlKSk7CisJCWJyZWFr
OworCisJY2FzZSBCUEZfQUxVNjQgfCBCUEZfTkVHOgorCQllbWl0X3J2MzJfYWx1X3I2NChkc3Qs
IHRtcDIsIGN0eCwgQlBGX09QKGNvZGUpKTsKKwkJYnJlYWs7CisKKwljYXNlIEJQRl9BTFU2NCB8
IEJQRl9ESVYgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9ESVYgfCBCUEZfSzoKKwlj
YXNlIEJQRl9BTFU2NCB8IEJQRl9NT0QgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFU2NCB8IEJQRl9N
T0QgfCBCUEZfSzoKKwkJZ290byBub3RzdXBwb3J0ZWQ7CisKKwljYXNlIEJQRl9BTFU2NCB8IEJQ
Rl9NT1YgfCBCUEZfSzoKKwkJZW1pdF9ydjMyX2FsdV9pNjQoZHN0LCBpbW0sIGN0eCwgQlBGX09Q
KGNvZGUpKTsKKwkJYnJlYWs7CisKKwljYXNlIEJQRl9BTFUgfCBCUEZfTU9WIHwgQlBGX1g6CisK
KwljYXNlIEJQRl9BTFUgfCBCUEZfQUREIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVIHwgQlBGX0FE
RCB8IEJQRl9LOgorCisJY2FzZSBCUEZfQUxVIHwgQlBGX1NVQiB8IEJQRl9YOgorCWNhc2UgQlBG
X0FMVSB8IEJQRl9TVUIgfCBCUEZfSzoKKworCWNhc2UgQlBGX0FMVSB8IEJQRl9BTkQgfCBCUEZf
WDoKKwljYXNlIEJQRl9BTFUgfCBCUEZfQU5EIHwgQlBGX0s6CisKKwljYXNlIEJQRl9BTFUgfCBC
UEZfT1IgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFUgfCBCUEZfT1IgfCBCUEZfSzoKKworCWNhc2Ug
QlBGX0FMVSB8IEJQRl9YT1IgfCBCUEZfWDoKKwljYXNlIEJQRl9BTFUgfCBCUEZfWE9SIHwgQlBG
X0s6CisKKwljYXNlIEJQRl9BTFUgfCBCUEZfTVVMIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVIHwg
QlBGX01VTCB8IEJQRl9LOgorCisJY2FzZSBCUEZfQUxVIHwgQlBGX0RJViB8IEJQRl9YOgorCWNh
c2UgQlBGX0FMVSB8IEJQRl9ESVYgfCBCUEZfSzoKKworCWNhc2UgQlBGX0FMVSB8IEJQRl9NT0Qg
fCBCUEZfWDoKKwljYXNlIEJQRl9BTFUgfCBCUEZfTU9EIHwgQlBGX0s6CisKKwljYXNlIEJQRl9B
TFUgfCBCUEZfTFNIIHwgQlBGX1g6CisJY2FzZSBCUEZfQUxVIHwgQlBGX0xTSCB8IEJQRl9LOgor
CisJY2FzZSBCUEZfQUxVIHwgQlBGX1JTSCB8IEJQRl9YOgorCWNhc2UgQlBGX0FMVSB8IEJQRl9S
U0ggfCBCUEZfSzoKKworCWNhc2UgQlBGX0FMVSB8IEJQRl9BUlNIIHwgQlBGX1g6CisJY2FzZSBC
UEZfQUxVIHwgQlBGX0FSU0ggfCBCUEZfSzoKKwkJaWYgKEJQRl9TUkMoY29kZSkgPT0gQlBGX0sp
IHsKKwkJCWVtaXRfaW1tMzIodG1wMiwgaW1tLCBjdHgpOworCQkJc3JjID0gdG1wMjsKKwkJfQor
CQllbWl0X3J2MzJfYWx1X3IzMihkc3QsIHNyYywgY3R4LCBCUEZfT1AoY29kZSkpOworCQlicmVh
azsKKworCWNhc2UgQlBGX0FMVSB8IEJQRl9NT1YgfCBCUEZfSzoKKwkJZW1pdF9ydjMyX2FsdV9p
MzIoZHN0LCBpbW0sIGN0eCwgQlBGX09QKGNvZGUpKTsKKwkJYnJlYWs7CisKKwljYXNlIEJQRl9B
TFUgfCBCUEZfTkVHOgorCQkvKiBzcmMgaXMgaWdub3JlZC0tLWNob29zZSBhIHJlZ2lzdGVyIGtu
b3duIG5vdCB0byBiZSBzdGFja2VkICovCisJCWVtaXRfcnYzMl9hbHVfcjMyKGRzdCwgdG1wMiwg
Y3R4LCBCUEZfT1AoY29kZSkpOworCQlicmVhazsKKworCWNhc2UgQlBGX0FMVSB8IEJQRl9FTkQg
fCBCUEZfRlJPTV9MRToKKwl7CisJCWNvbnN0IHM4ICpyZCA9IHJ2MzJfYnBmX2dldF9yZWc2NChk
c3QsIHRtcDEsIGN0eCk7CisKKwkJc3dpdGNoIChpbW0pIHsKKwkJY2FzZSAxNjoKKwkJCWVtaXQo
cnZfc2xsaShyZFsxXSwgcmRbMV0sIDE2KSwgY3R4KTsKKwkJCWVtaXQocnZfc3JsaShyZFsxXSwg
cmRbMV0sIDE2KSwgY3R4KTsKKwkJCS8qIEZhbGx0aHJvdWdoIHRvIGNsZWFyIGhpZ2ggYml0cy4g
Ki8KKwkJY2FzZSAzMjoKKwkJCWVtaXQocnZfYWRkaShyZFswXSwgUlZfUkVHX1pFUk8sIDApLCBj
dHgpOworCQkJYnJlYWs7CisJCWNhc2UgNjQ6CisJCQkvKiBEbyBub3RoaW5nLiAqLworCQkJYnJl
YWs7CisJCWRlZmF1bHQ6CisJCQlwcl9lcnIoImJwZi1qaXQ6IEJQRl9FTkQgaW1tICVkIGludmFs
aWRcbiIsIGltbSk7CisJCQlyZXR1cm4gLTE7CisJCX0KKworCQlydjMyX2JwZl9wdXRfcmVnNjQo
ZHN0LCByZCwgY3R4KTsKKwkJYnJlYWs7CisJfQorCisJY2FzZSBCUEZfQUxVIHwgQlBGX0VORCB8
IEJQRl9GUk9NX0JFOgorCXsKKwkJY29uc3QgczggKnJkID0gcnYzMl9icGZfZ2V0X3JlZzY0KGRz
dCwgdG1wMSwgY3R4KTsKKworCQlzd2l0Y2ggKGltbSkgeworCQljYXNlIDE2OgorCQkJZW1pdF9y
djMyX3JldjE2KHJkWzFdLCBjdHgpOworCQkJZW1pdChydl9hZGRpKHJkWzBdLCBSVl9SRUdfWkVS
TywgMCksIGN0eCk7CisJCQlicmVhazsKKwkJY2FzZSAzMjoKKwkJCWVtaXRfcnYzMl9yZXYzMihy
ZFsxXSwgY3R4KTsKKwkJCWVtaXQocnZfYWRkaShyZFswXSwgUlZfUkVHX1pFUk8sIDApLCBjdHgp
OworCQkJYnJlYWs7CisJCWNhc2UgNjQ6CisJCQkvKiBTd2FwIHVwcGVyIGFuZCBsb3dlciBoYWx2
ZXMuICovCisJCQllbWl0KHJ2X2FkZGkoUlZfUkVHX1QwLCByZFsxXSwgMCksIGN0eCk7CisJCQll
bWl0KHJ2X2FkZGkocmRbMV0sIHJkWzBdLCAwKSwgY3R4KTsKKwkJCWVtaXQocnZfYWRkaShyZFsw
XSwgUlZfUkVHX1QwLCAwKSwgY3R4KTsKKworCQkJLyogU3dhcCBlYWNoIGhhbGYuICovCisJCQll
bWl0X3J2MzJfcmV2MzIocmRbMV0sIGN0eCk7CisJCQllbWl0X3J2MzJfcmV2MzIocmRbMF0sIGN0
eCk7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCXByX2VycigiYnBmLWppdDogQlBGX0VORCBp
bW0gJWQgaW52YWxpZFxuIiwgaW1tKTsKKwkJCXJldHVybiAtMTsKKwkJfQorCisJCXJ2MzJfYnBm
X3B1dF9yZWc2NChkc3QsIHJkLCBjdHgpOworCQlicmVhazsKKwl9CisKKwljYXNlIEJQRl9KTVAg
fCBCUEZfSkE6CisJCXJ2b2ZmID0gcnZfb2Zmc2V0KGkgKyBvZmYsIGksIGN0eCk7CisJCWlmICgh
aXNfMjFiX2ludChydm9mZikpIHsKKwkJCXByX2VycigiYnBmLWppdDogaW5zbj0lZCBvZmZzZXQ9
JWQgbm90IHN1cHBvcnRlZCB5ZXQhXG4iLAorCQkJICAgICAgIGksIHJ2b2ZmKTsKKwkJCXJldHVy
biAtMTsKKwkJfQorCQllbWl0KHJ2X2phbChSVl9SRUdfWkVSTywgcnZvZmYgPj4gMSksIGN0eCk7
CisJCWJyZWFrOworCisJY2FzZSBCUEZfSk1QIHwgQlBGX0NBTEw6CisJeworCQlib29sIGZpeGVk
OworCQlpbnQgcmV0OworCQl1NjQgYWRkcjsKKwkJY29uc3QgczggKnIwID0gYnBmMnJ2MzJbQlBG
X1JFR18wXTsKKwkJY29uc3QgczggKnI1ID0gYnBmMnJ2MzJbQlBGX1JFR181XTsKKworCQlyZXQg
PSBicGZfaml0X2dldF9mdW5jX2FkZHIoY3R4LT5wcm9nLCBpbnNuLCBleHRyYV9wYXNzLCAmYWRk
ciwKKwkJCQkJICAgICZmaXhlZCk7CisJCWlmIChyZXQgPCAwKQorCQkJcmV0dXJuIHJldDsKKwkJ
aWYgKGZpeGVkKSB7CisJCQllbWl0X2ltbShSVl9SRUdfVDAsICh1MzIpIGFkZHIsIGN0eCk7CisJ
CX0gZWxzZSB7CisJCQlwcl9lcnIoImJwZi1qaXQ6IHBzZXVkb2NhbGwgY2FsbCBub3Qgc3VwcG9y
dGVkIHlldCFcbiIpOworCQkJcmV0dXJuIC0xOworCQl9CisKKwkJLyogUjEtUjQgYWxyZWFkeSBp
biBjb3JyZWN0IHJlaWdzdGVycy0tLW5lZWQgdG8gcHVzaCBSNSB0byBzdGFjayAqLworCQllbWl0
KHJ2X2FkZGkoUlZfUkVHX1NQLCBSVl9SRUdfU1AsIC04KSwgY3R4KTsKKwkJZW1pdChydl9zdyhS
Vl9SRUdfU1AsIDAsIHI1WzFdKSwgY3R4KTsKKwkJZW1pdChydl9zdyhSVl9SRUdfU1AsIDQsIHI1
WzBdKSwgY3R4KTsKKworCQllbWl0KHJ2X2phbHIoUlZfUkVHX1JBLCBSVl9SRUdfVDAsIDApLCBj
dHgpOworCisJCS8qIFNldCByZXR1cm4gdmFsdWUgKi8KKwkJZW1pdChydl9hZGRpKHIwWzFdLCBS
Vl9SRUdfQTAsIDApLCBjdHgpOworCQllbWl0KHJ2X2FkZGkocjBbMF0sIFJWX1JFR19BMSwgMCks
IGN0eCk7CisJCWVtaXQocnZfYWRkaShSVl9SRUdfU1AsIFJWX1JFR19TUCwgOCksIGN0eCk7CisJ
CWJyZWFrOworCX0KKworCWNhc2UgQlBGX0pNUCB8IEJQRl9KRVEgfCBCUEZfWDoKKwljYXNlIEJQ
Rl9KTVAgfCBCUEZfSkVRIHwgQlBGX0s6CisJY2FzZSBCUEZfSk1QMzIgfCBCUEZfSkVRIHwgQlBG
X1g6CisJY2FzZSBCUEZfSk1QMzIgfCBCUEZfSkVRIHwgQlBGX0s6CisKKwljYXNlIEJQRl9KTVAg
fCBCUEZfSk5FIHwgQlBGX1g6CisJY2FzZSBCUEZfSk1QIHwgQlBGX0pORSB8IEJQRl9LOgorCWNh
c2UgQlBGX0pNUDMyIHwgQlBGX0pORSB8IEJQRl9YOgorCWNhc2UgQlBGX0pNUDMyIHwgQlBGX0pO
RSB8IEJQRl9LOgorCisJY2FzZSBCUEZfSk1QIHwgQlBGX0pMRSB8IEJQRl9YOgorCWNhc2UgQlBG
X0pNUCB8IEJQRl9KTEUgfCBCUEZfSzoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KTEUgfCBCUEZf
WDoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KTEUgfCBCUEZfSzoKKworCWNhc2UgQlBGX0pNUCB8
IEJQRl9KTFQgfCBCUEZfWDoKKwljYXNlIEJQRl9KTVAgfCBCUEZfSkxUIHwgQlBGX0s6CisJY2Fz
ZSBCUEZfSk1QMzIgfCBCUEZfSkxUIHwgQlBGX1g6CisJY2FzZSBCUEZfSk1QMzIgfCBCUEZfSkxU
IHwgQlBGX0s6CisKKwljYXNlIEJQRl9KTVAgfCBCUEZfSkdFIHwgQlBGX1g6CisJY2FzZSBCUEZf
Sk1QIHwgQlBGX0pHRSB8IEJQRl9LOgorCWNhc2UgQlBGX0pNUDMyIHwgQlBGX0pHRSB8IEJQRl9Y
OgorCWNhc2UgQlBGX0pNUDMyIHwgQlBGX0pHRSB8IEJQRl9LOgorCisJY2FzZSBCUEZfSk1QIHwg
QlBGX0pHVCB8IEJQRl9YOgorCWNhc2UgQlBGX0pNUCB8IEJQRl9KR1QgfCBCUEZfSzoKKwljYXNl
IEJQRl9KTVAzMiB8IEJQRl9KR1QgfCBCUEZfWDoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KR1Qg
fCBCUEZfSzoKKworCWNhc2UgQlBGX0pNUCB8IEJQRl9KU0xFIHwgQlBGX1g6CisJY2FzZSBCUEZf
Sk1QIHwgQlBGX0pTTEUgfCBCUEZfSzoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KU0xFIHwgQlBG
X1g6CisJY2FzZSBCUEZfSk1QMzIgfCBCUEZfSlNMRSB8IEJQRl9LOgorCisJY2FzZSBCUEZfSk1Q
IHwgQlBGX0pTTFQgfCBCUEZfWDoKKwljYXNlIEJQRl9KTVAgfCBCUEZfSlNMVCB8IEJQRl9LOgor
CWNhc2UgQlBGX0pNUDMyIHwgQlBGX0pTTFQgfCBCUEZfWDoKKwljYXNlIEJQRl9KTVAzMiB8IEJQ
Rl9KU0xUIHwgQlBGX0s6CisKKwljYXNlIEJQRl9KTVAgfCBCUEZfSlNHRSB8IEJQRl9YOgorCWNh
c2UgQlBGX0pNUCB8IEJQRl9KU0dFIHwgQlBGX0s6CisJY2FzZSBCUEZfSk1QMzIgfCBCUEZfSlNH
RSB8IEJQRl9YOgorCWNhc2UgQlBGX0pNUDMyIHwgQlBGX0pTR0UgfCBCUEZfSzoKKworCWNhc2Ug
QlBGX0pNUCB8IEJQRl9KU0dUIHwgQlBGX1g6CisJY2FzZSBCUEZfSk1QIHwgQlBGX0pTR1QgfCBC
UEZfSzoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KU0dUIHwgQlBGX1g6CisJY2FzZSBCUEZfSk1Q
MzIgfCBCUEZfSlNHVCB8IEJQRl9LOgorCisJY2FzZSBCUEZfSk1QIHwgQlBGX0pTRVQgfCBCUEZf
WDoKKwljYXNlIEJQRl9KTVAgfCBCUEZfSlNFVCB8IEJQRl9LOgorCWNhc2UgQlBGX0pNUDMyIHwg
QlBGX0pTRVQgfCBCUEZfWDoKKwljYXNlIEJQRl9KTVAzMiB8IEJQRl9KU0VUIHwgQlBGX0s6CisJ
CWlmIChCUEZfU1JDKGNvZGUpID09IEJQRl9LKSB7CisJCQllbWl0X2ltbTMyKHRtcDIsIGltbSwg
Y3R4KTsKKwkJCXNyYyA9IHRtcDI7CisJCX0KKwkJc3dpdGNoIChCUEZfQ0xBU1MoY29kZSkpIHsK
KwkJY2FzZSBCUEZfSk1QOgorCQkJaWYgKGVtaXRfcnYzMl9qdW1wX3I2NChkc3QsIHNyYywgb2Zm
LCBpLCBjdHgsIEJQRl9PUChjb2RlKSkpCisJCQkJcmV0dXJuIC0xOworCQkJYnJlYWs7CisJCWNh
c2UgQlBGX0pNUDMyOgorCQkJaWYgKGVtaXRfcnYzMl9qdW1wX3IzMihkc3QsIHNyYywgb2ZmLCBp
LCBjdHgsIEJQRl9PUChjb2RlKSkpCisJCQkJcmV0dXJuIC0xOworCQkJYnJlYWs7CisJCX0KKwkJ
YnJlYWs7CisKKwljYXNlIEJQRl9KTVAgfCBCUEZfRVhJVDoKKwkJaWYgKGkgPT0gY3R4LT5wcm9n
LT5sZW4gLSAxKQorCQkJYnJlYWs7CisKKwkJcnZvZmYgPSBlcGlsb2d1ZV9vZmZzZXQoY3R4KTsK
KwkJaWYgKGlzXzIxYl9jaGVjayhydm9mZiwgaSkpCisJCQlyZXR1cm4gLTE7CisJCWVtaXQocnZf
amFsKFJWX1JFR19aRVJPLCBydm9mZiA+PiAxKSwgY3R4KTsKKwkJYnJlYWs7CisKKwljYXNlIEJQ
Rl9MRCB8IEJQRl9JTU0gfCBCUEZfRFc6CisJeworCQlzdHJ1Y3QgYnBmX2luc24gaW5zbjEgPSBp
bnNuWzFdOworCQlzMzIgaW1tX2xvID0gaW1tOworCQlzMzIgaW1tX2hpID0gaW5zbjEuaW1tOwor
CQljb25zdCBzOCAqcmQgPSBydjMyX2JwZl9nZXRfcmVnNjQoZHN0LCB0bXAxLCBjdHgpOworCisJ
CWVtaXRfaW1tNjQocmQsIGltbV9oaSwgaW1tX2xvLCBjdHgpOworCQlydjMyX2JwZl9wdXRfcmVn
NjQoZHN0LCByZCwgY3R4KTsKKwkJcmV0dXJuIDE7CisJfQorCisJY2FzZSBCUEZfTERYIHwgQlBG
X01FTSB8IEJQRl9COgorCWNhc2UgQlBGX0xEWCB8IEJQRl9NRU0gfCBCUEZfSDoKKwljYXNlIEJQ
Rl9MRFggfCBCUEZfTUVNIHwgQlBGX1c6CisJY2FzZSBCUEZfTERYIHwgQlBGX01FTSB8IEJQRl9E
VzoKKwkJaWYgKGVtaXRfcnYzMl9sb2FkX3I2NChkc3QsIHNyYywgb2ZmLCBjdHgsIEJQRl9TSVpF
KGNvZGUpKSkKKwkJCXJldHVybiAtMTsKKwkJYnJlYWs7CisKKworCWNhc2UgQlBGX1NUIHwgQlBG
X01FTSB8IEJQRl9COgorCWNhc2UgQlBGX1NUWCB8IEJQRl9NRU0gfCBCUEZfQjoKKwljYXNlIEJQ
Rl9TVCB8IEJQRl9NRU0gfCBCUEZfSDoKKwljYXNlIEJQRl9TVFggfCBCUEZfTUVNIHwgQlBGX0g6
CisJY2FzZSBCUEZfU1QgfCBCUEZfTUVNIHwgQlBGX1c6CisJY2FzZSBCUEZfU1RYIHwgQlBGX01F
TSB8IEJQRl9XOgorCWNhc2UgQlBGX1NUIHwgQlBGX01FTSB8IEJQRl9EVzoKKwljYXNlIEJQRl9T
VFggfCBCUEZfTUVNIHwgQlBGX0RXOgorCisJY2FzZSBCUEZfU1RYIHwgQlBGX1hBREQgfCBCUEZf
VzoKKwkJaWYgKEJQRl9DTEFTUyhjb2RlKSA9PSBCUEZfU1QpIHsKKwkJCWVtaXRfaW1tMzIodG1w
MiwgaW1tLCBjdHgpOworCQkJc3JjID0gdG1wMjsKKwkJfQorCisJCWlmIChlbWl0X3J2MzJfc3Rv
cmVfcjY0KGRzdCwgc3JjLCBvZmYsIGN0eCwgQlBGX1NJWkUoY29kZSksIEJQRl9NT0RFKGNvZGUp
KSkKKwkJCXJldHVybiAtMTsKKwkJYnJlYWs7CisKKwljYXNlIEJQRl9TVFggfCBCUEZfWEFERCB8
IEJQRl9EVzoKKwkJZ290byBub3RzdXBwb3J0ZWQ7CisKK25vdHN1cHBvcnRlZDoKKwkJcHJfaW5m
b19vbmNlKCIqKiogTk9UIFNVUFBPUlRFRDogb3Bjb2RlICUwMnggKioqXG4iLCBjb2RlKTsKKwkJ
cmV0dXJuIC1FRkFVTFQ7CisKKwlkZWZhdWx0OgorCQlwcl9lcnIoImJwZi1qaXQ6IHVua25vd24g
b3Bjb2RlICUwMnhcbiIsIGNvZGUpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQgYnVpbGRfcHJvbG9ndWUoc3RydWN0IHJ2X2ppdF9jb250ZXh0
ICpjdHgpCit7CisJaW50IHN0YWNrX2FkanVzdCA9IDMyLCBzdG9yZV9vZmZzZXQsIGJwZl9zdGFj
a19hZGp1c3Q7CisKKwlzdGFja19hZGp1c3QgPSByb3VuZF91cChzdGFja19hZGp1c3QsIDE2KTsK
KwlicGZfc3RhY2tfYWRqdXN0ID0gcm91bmRfdXAoY3R4LT5wcm9nLT5hdXgtPnN0YWNrX2RlcHRo
LCAxNik7CisJc3RhY2tfYWRqdXN0ICs9IGJwZl9zdGFja19hZGp1c3Q7CisKKwlzdG9yZV9vZmZz
ZXQgPSBzdGFja19hZGp1c3QgLSA4OworCisJc3RhY2tfYWRqdXN0ICs9IDQgKiBCUEZfSklUX1ND
UkFUQ0hfUkVHUzsKKworCWVtaXQocnZfYWRkaShSVl9SRUdfU1AsIFJWX1JFR19TUCwgLXN0YWNr
X2FkanVzdCksIGN0eCk7CisKKwkvKiBTYXZlIGNhbGxlZS1zYXZlIHJlZ2lzdGVycyAqLworCWVt
aXQocnZfc3coUlZfUkVHX1NQLCBzdG9yZV9vZmZzZXQgLSAwLCBSVl9SRUdfUkEpLCBjdHgpOwor
CWVtaXQocnZfc3coUlZfUkVHX1NQLCBzdG9yZV9vZmZzZXQgLSA0LCBSVl9SRUdfRlApLCBjdHgp
OworCWVtaXQocnZfc3coUlZfUkVHX1NQLCBzdG9yZV9vZmZzZXQgLSA4LCBSVl9SRUdfUzEpLCBj
dHgpOworCWVtaXQocnZfc3coUlZfUkVHX1NQLCBzdG9yZV9vZmZzZXQgLSAxMiwgUlZfUkVHX1My
KSwgY3R4KTsKKwllbWl0KHJ2X3N3KFJWX1JFR19TUCwgc3RvcmVfb2Zmc2V0IC0gMTYsIFJWX1JF
R19TMyksIGN0eCk7CisJZW1pdChydl9zdyhSVl9SRUdfU1AsIHN0b3JlX29mZnNldCAtIDIwLCBS
Vl9SRUdfUzQpLCBjdHgpOworCWVtaXQocnZfc3coUlZfUkVHX1NQLCBzdG9yZV9vZmZzZXQgLSAy
NCwgUlZfUkVHX1M1KSwgY3R4KTsKKwllbWl0KHJ2X3N3KFJWX1JFR19TUCwgc3RvcmVfb2Zmc2V0
IC0gMjgsIFJWX1JFR19TNiksIGN0eCk7CisKKwllbWl0KHJ2X2FkZGkoUlZfUkVHX0ZQLCBSVl9S
RUdfU1AsIHN0YWNrX2FkanVzdCksIGN0eCk7CisKKwkvKiBTZXQgdXAgQlBGIHN0YWNrIHBvaW50
ZXIgKi8KKwllbWl0KHJ2X2FkZGkoYnBmMnJ2MzJbQlBGX1JFR19GUF1bMV0sIFJWX1JFR19TUCwg
YnBmX3N0YWNrX2FkanVzdCksIGN0eCk7CisJZW1pdChydl9hZGRpKGJwZjJydjMyW0JQRl9SRUdf
RlBdWzBdLCBSVl9SRUdfWkVSTywgMCksIGN0eCk7CisKKwkvKiBTZXQgdXAgY29udGV4dCBwb2lu
dGVyICovCisJZW1pdChydl9hZGRpKGJwZjJydjMyW0JQRl9SRUdfMV1bMV0sIFJWX1JFR19BMCwg
MCksIGN0eCk7CisJZW1pdChydl9hZGRpKGJwZjJydjMyW0JQRl9SRUdfMV1bMF0sIFJWX1JFR19a
RVJPLCAwKSwgY3R4KTsKKworCWN0eC0+c3RhY2tfc2l6ZSA9IHN0YWNrX2FkanVzdDsKK30KKwor
c3RhdGljIGludCBidWlsZF9ib2R5KHN0cnVjdCBydl9qaXRfY29udGV4dCAqY3R4LCBib29sIGV4
dHJhX3Bhc3MpCit7CisJY29uc3Qgc3RydWN0IGJwZl9wcm9nICpwcm9nID0gY3R4LT5wcm9nOwor
CWludCBpOworCisJZm9yIChpID0gMDsgaSA8IHByb2ctPmxlbjsgaSsrKSB7CisJCWNvbnN0IHN0
cnVjdCBicGZfaW5zbiAqaW5zbiA9ICZwcm9nLT5pbnNuc2lbaV07CisJCWludCByZXQ7CisKKwkJ
cmV0ID0gZW1pdF9pbnNuKGluc24sIGN0eCwgZXh0cmFfcGFzcyk7CisJCWlmIChyZXQgPiAwKSB7
CisJCQlpKys7CisJCQlpZiAoY3R4LT5pbnNucyA9PSBOVUxMKQorCQkJCWN0eC0+b2Zmc2V0W2ld
ID0gY3R4LT5uaW5zbnM7CisJCQljb250aW51ZTsKKwkJfQorCQlpZiAoY3R4LT5pbnNucyA9PSBO
VUxMKQorCQkJY3R4LT5vZmZzZXRbaV0gPSBjdHgtPm5pbnNuczsKKwkJaWYgKHJldCkKKwkJCXJl
dHVybiByZXQ7CisJfQorCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBicGZfZmlsbF9pbGxf
aW5zbnModm9pZCAqYXJlYSwgdW5zaWduZWQgaW50IHNpemUpCit7CisJbWVtc2V0KGFyZWEsIDAs
IHNpemUpOworfQorCitzdGF0aWMgdm9pZCBicGZfZmx1c2hfaWNhY2hlKHZvaWQgKnN0YXJ0LCB2
b2lkICplbmQpCit7CisJZmx1c2hfaWNhY2hlX3JhbmdlKCh1bnNpZ25lZCBsb25nKXN0YXJ0LCAo
dW5zaWduZWQgbG9uZyllbmQpOworfQorCitzdHJ1Y3QgYnBmX3Byb2cgKmJwZl9pbnRfaml0X2Nv
bXBpbGUoc3RydWN0IGJwZl9wcm9nICpwcm9nKQoreworCWJvb2wgdG1wX2JsaW5kZWQgPSBmYWxz
ZSwgZXh0cmFfcGFzcyA9IGZhbHNlOworCXN0cnVjdCBicGZfcHJvZyAqdG1wLCAqb3JpZ19wcm9n
ID0gcHJvZzsKKwlzdHJ1Y3QgcnZfaml0X2RhdGEgKmppdF9kYXRhOworCXN0cnVjdCBydl9qaXRf
Y29udGV4dCAqY3R4OworCXVuc2lnbmVkIGludCBpbWFnZV9zaXplOworCisJaWYgKCFwcm9nLT5q
aXRfcmVxdWVzdGVkKQorCQlyZXR1cm4gb3JpZ19wcm9nOworCisJdG1wID0gYnBmX2ppdF9ibGlu
ZF9jb25zdGFudHMocHJvZyk7CisJaWYgKElTX0VSUih0bXApKQorCQlyZXR1cm4gb3JpZ19wcm9n
OworCWlmICh0bXAgIT0gcHJvZykgeworCQl0bXBfYmxpbmRlZCA9IHRydWU7CisJCXByb2cgPSB0
bXA7CisJfQorCisJaml0X2RhdGEgPSBwcm9nLT5hdXgtPmppdF9kYXRhOworCWlmICghaml0X2Rh
dGEpIHsKKwkJaml0X2RhdGEgPSBremFsbG9jKHNpemVvZigqaml0X2RhdGEpLCBHRlBfS0VSTkVM
KTsKKwkJaWYgKCFqaXRfZGF0YSkgeworCQkJcHJvZyA9IG9yaWdfcHJvZzsKKwkJCWdvdG8gb3V0
OworCQl9CisJCXByb2ctPmF1eC0+aml0X2RhdGEgPSBqaXRfZGF0YTsKKwl9CisKKwljdHggPSAm
aml0X2RhdGEtPmN0eDsKKworCWlmIChjdHgtPm9mZnNldCkgeworCQlleHRyYV9wYXNzID0gdHJ1
ZTsKKwkJaW1hZ2Vfc2l6ZSA9IHNpemVvZih1MzIpICogY3R4LT5uaW5zbnM7CisJCWdvdG8gc2tp
cF9pbml0X2N0eDsKKwl9CisKKwljdHgtPnByb2cgPSBwcm9nOworCWN0eC0+b2Zmc2V0ID0ga2Nh
bGxvYyhwcm9nLT5sZW4sIHNpemVvZihpbnQpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWN0eC0+b2Zm
c2V0KSB7CisJCXByb2cgPSBvcmlnX3Byb2c7CisJCWdvdG8gb3V0X29mZnNldDsKKwl9CisKKwkv
KiBGaXJzdCBwYXNzIGdlbmVyYXRlcyB0aGUgY3R4LT5vZmZzZXQsIGJ1dCBkb2VzIG5vdCBlbWl0
IGFuIGltYWdlLiAqLworCWlmIChidWlsZF9ib2R5KGN0eCwgZXh0cmFfcGFzcykpIHsKKwkJcHJv
ZyA9IG9yaWdfcHJvZzsKKwkJZ290byBvdXRfb2Zmc2V0OworCX0KKwlidWlsZF9wcm9sb2d1ZShj
dHgpOworCWN0eC0+ZXBpbG9ndWVfb2Zmc2V0ID0gY3R4LT5uaW5zbnM7CisJYnVpbGRfZXBpbG9n
dWUoY3R4KTsKKworCS8qIEFsbG9jYXRlIGltYWdlLCBub3cgdGhhdCB3ZSBrbm93IHRoZSBzaXpl
LiAqLworCWltYWdlX3NpemUgPSBzaXplb2YodTMyKSAqIGN0eC0+bmluc25zOworCWppdF9kYXRh
LT5oZWFkZXIgPSBicGZfaml0X2JpbmFyeV9hbGxvYyhpbWFnZV9zaXplLCAmaml0X2RhdGEtPmlt
YWdlLAorCQkJCQkJc2l6ZW9mKHUzMiksCisJCQkJCQlicGZfZmlsbF9pbGxfaW5zbnMpOworCWlm
ICghaml0X2RhdGEtPmhlYWRlcikgeworCQlwcm9nID0gb3JpZ19wcm9nOworCQlnb3RvIG91dF9v
ZmZzZXQ7CisJfQorCisJLyogU2Vjb25kLCByZWFsIHBhc3MsIHRoYXQgYWN1dGFsbHkgZW1pdHMg
dGhlIGltYWdlLiAqLworCWN0eC0+aW5zbnMgPSAodTMyICopaml0X2RhdGEtPmltYWdlOworc2tp
cF9pbml0X2N0eDoKKwljdHgtPm5pbnNucyA9IDA7CisKKwlidWlsZF9wcm9sb2d1ZShjdHgpOwor
CWlmIChidWlsZF9ib2R5KGN0eCwgZXh0cmFfcGFzcykpIHsKKwkJYnBmX2ppdF9iaW5hcnlfZnJl
ZShqaXRfZGF0YS0+aGVhZGVyKTsKKwkJcHJvZyA9IG9yaWdfcHJvZzsKKwkJZ290byBvdXRfb2Zm
c2V0OworCX0KKwlidWlsZF9lcGlsb2d1ZShjdHgpOworCisJaWYgKGJwZl9qaXRfZW5hYmxlID4g
MSkKKwkJYnBmX2ppdF9kdW1wKHByb2ctPmxlbiwgaW1hZ2Vfc2l6ZSwgMiwgY3R4LT5pbnNucyk7
CisKKwlwcm9nLT5icGZfZnVuYyA9ICh2b2lkICopY3R4LT5pbnNuczsKKwlwcm9nLT5qaXRlZCA9
IDE7CisJcHJvZy0+aml0ZWRfbGVuID0gaW1hZ2Vfc2l6ZTsKKworCWJwZl9mbHVzaF9pY2FjaGUo
aml0X2RhdGEtPmhlYWRlciwgY3R4LT5pbnNucyArIGN0eC0+bmluc25zKTsKKworCWlmICghcHJv
Zy0+aXNfZnVuYyB8fCBleHRyYV9wYXNzKSB7CitvdXRfb2Zmc2V0OgorCQlrZnJlZShjdHgtPm9m
ZnNldCk7CisJCWtmcmVlKGppdF9kYXRhKTsKKwkJcHJvZy0+YXV4LT5qaXRfZGF0YSA9IE5VTEw7
CisJfQorb3V0OgorCWlmICh0bXBfYmxpbmRlZCkKKwkJYnBmX2ppdF9wcm9nX3JlbGVhc2Vfb3Ro
ZXIocHJvZywgcHJvZyA9PSBvcmlnX3Byb2cgPworCQkJCQkgICB0bXAgOiBvcmlnX3Byb2cpOwor
CXJldHVybiBwcm9nOworfQotLSAKMi4yMC4xCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KbGludXgtcmlzY3YgbWFpbGluZyBsaXN0CmxpbnV4LXJpc2N2
QGxpc3RzLmluZnJhZGVhZC5vcmcKaHR0cDovL2xpc3RzLmluZnJhZGVhZC5vcmcvbWFpbG1hbi9s
aXN0aW5mby9saW51eC1yaXNjdgo=
